<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcomLik Stock - Gestion Professionnelle</title>
    <link rel="icon" type="image/png" href="data:image/webp;base64,UklGRl4lAABXRUJQVlA4WAoAAAAgAAAAfwIAfwIASUNDUMgBAAAAAAHIAAAAAAQwAABtbnRyUkdCIFhZWiAH4AABAAEAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAACRyWFlaAAABFAAAABRnWFlaAAABKAAAABRiWFlaAAABPAAAABR3dHB0AAABUAAAABRyVFJDAAABZAAAAChnVFJDAAABZAAAAChiVFJDAAABZAAAAChjcHJ0AAABjAAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAAgAAAAcAHMAUgBHAEJYWVogAAAAAAAAb6IAADj1AAADkFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAACSgAAAPhAAAts9YWVogAAAAAAAA9tYAAQAAAADTLXBhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABtbHVjAAAAAAAAAAEAAAAMZW5VUwAAACAAAAAcAEcAbwBvAGcAbABlACAASQBuAGMALgAgADIAMAAxADZWUDggcCMAANDfAJ0BKoACgAI+USiSRiOkoaEkNJhIkAoJZ27hdY5kcAOFbfH1x8afS/mP7TVqfuP4Y/u/zcfyu6jsjy4PJ/1r/Zf4L8jfm9/xvWn+hv+r7i/6n/6r/Df5L9nfjW9eXmx/cT9zPbR6ST/udfB6Vnmm/9L9xPiX/ZD9nfad1PV7v+U/z/iz5g/bPth+7n2N4o/lvA/+cfeb9V/hf3E/Mn8Dfef4u8Aj8q/nv+X/sn7gfmdzHABfzj+2/8n0yvw/Q37R/8TztfYnxtKBX6K9IrU+9a/+z2Of7p/xBA1cOq27gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7f6jmkiXyCpza7gDm4ZfIKnNraVr7aF64O+wqjKvaiXtRL2ol7US60W/Pc3/UJR4dVt3AHNwy+QVOGn+uGgM7LoRy7SSBJmg7A7pOqyDLqRL5BU5tdwBzcMavZ171JbC34LVT74cBVSPuuZBhhbGgFsnDAmPcoWi/m5r/KqYje4dVt3AHNwy+QUV3Q7JXuCiUvdYPjYJNG1eZGBoLc8liN7fHoQ4K0siUzTR/HzIAh7R0c3DL5BU5tdwBzRT4espWY1N5oob2qcTl4jgC3+baBCP//BWKLKtu4A5uGXyCpza7gCyR4Tv9iffUhhoqNol/qKw1wiyWvGReluI/PEWIXrcoXDqtu4A5uGXyCpMp9wGSF75HqJxPj4Fe7c+v0Sa7zvUM2u4A5uGXyCpza7gDjA5UJO6k3itPmH2ERN/RWOXA3uw8sX9P/65bB8Jl0wHNwy+QVObXcAc3DVyufYnAIXhU9hGv6GUr9y76hl4ceR5VqkS+QVObXcAc3DL5BU7W0srr4JodkBn+QgtpJNrxboI3cAc3DL5BU5tdwBzcMxXxX2gHWlazWztuJ0hJ//8TMxBgBzcMvkFTm12/0MD3fNJGTI+Htdo8SrEhPVFfLCZ2tOVw6rbuAU9WdutJyiPUim00AplYFbMLV1KgPoY+ooRFXc1B820fUstEkL4OV7wnGhfTTfQH5xinWkBpgObhl7qZD0dP7EHXOOXoPafFIJDfiRAFD/eviFpnqjXRwjkYtFWi9c+VkQZUy6+85Diau+RWEEYTbIcrVi8XseW86krU+DhfQMtPKdlNYg+T+9priokvPl10DD8IX0GlBsPDeqVl0grzeA/VSBJ3AHNwy4KvDMEMjeTcFGTLLPJFy2KuzP58Uy8VkzxCddx6OlVtDI6jNS6feWQEXVkQejrJ+OEpS8h7hnVyBPqPKQsR+5kvOfrRZy4nS8oVRjuad6mz4k/7saX38sLNruAObhjekUqiPeu1PPU2lyp/rDGfZE5/PnWVMkyMdw/6xW/QtR/2u2JZKEKePdyZy6n9A/PfdEx1AMpO7v3pV/vycxmLff3/2fe5oQHmaT9dQpES0f/E/rqrlu+D3GP833W6H1xs3DL5BU8fkUhp5GqQSOJK75qVxbYAtv4oBlMH1brEZLb+3kszmh8DB5eN3nz1hcTTPxEbMsjBycMTd0N8i2cKjXMLwBP0MRqIaMrvsZHnHm8hFTTTX9XyXt+NXM8toq3QkS+QVOZqpHYBY5CoHNvp99DTxW3hRxJvUZwbZtZ2HC1wFxXS/SACvAvq/9b7YhxYdvXPwHUkyaM3VVvyWvfrU/fbPn2RcLn1HuAbWEJd2Z1GcnwP22AftnlQL+cr2pvJxz9e7VGcD05pIl8gUDKFNzSQdAnMO9x+9OG1crGg8MUCZNDLk9XkxRg4no4m+MXJSNrHRAgsEmTTatM4ANieVDrfEOWzrg9xLAYzaiIfxgHoaHctoIOyRUaNeRz8e44t9n9q3lamop9OrOwkmSrRv1V2kVPzQXBVrXrZhgYgR+66XuSgtR0MHzmergKOzCpQx2WrtSTeRL5BU5tALEyII2QyVMbIrwVfmurvUxCIQ8pQ/zAAbLUIy5DVn77NWA6CpVN/8AhfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqcygAP7/xLAAAAAAAAAAAAAAAAHhgBEbys1Bjv5GTjFRkjfKaiafjQ3UjRwIwpTYRO4fQzB3pTE75RAOfolmT8NPj7aq2aB1XOaIGlThu16sEdj2rjiHQovaCoketM4kO9OyoYaIVWJOjp3qrh0et5XlS4Oejg5CBhiTjpatIpyGtyd0zfEgOgPVzwPXTmN4A410DeJ2NTIviPQVEUlOcFCi+pU2B/y8QsQkwLvMhNgEGmBP/PRKT39FoyTvq8Q6T4TR7SaK8u8x93LamRSfZCTVvUd37IBUrXASeXNWkZy++4uCHXIFB5NzBrCEXnapjh6KUJ2xGmSI9SXZT9dtRkwPhdSKG3IvtKVIEpJ4xwjIhaxIK1O+xuJBg5n0l24Il36KP/KXszRvDL+KhQHCUOQrLjEu6j4pOLH5A5xWf6pRdlkpwvZiYmliP2O0JNvBVWUp7WWJ1UJY6TkWtB4I0oA9vh6XiVH5A6uOKoNB0nClMxbnSjpY4C1bzhPJSRuD68G/iuxmjxXpz+DLV/SjwharFVRufM+oQwGzJTs4RG0yTFbgl+pBHmhoJGlUXBHtLAIvKrZqzzyY0L342U87Bv6ZWjxBaro6YLSGtfj4aSHZ9vOYAwpMZvunhSu5q4iGcbl8g0S+5RlQMptyAq64BFlCv8JhOq/WDqfyha3ZJC+g06YG3mBf/qedJPC6azG626evy8H7bxDPeo/SnqqQDActvSjr+310gzCIYhNIU3bN/w1BGTnSFRZZup+4Y1nD1yTdpMYfYSS0XQbq0Q0A6zn+WadP9Ap5AaS3yXBUYov6ZaGCnaBI25g20g5TJTZvU5OczEOsLfxeUXLTm8P/bhhJPRnI6YSCRieOcSf/32rFVlWgskGc88bPR13SQHQAtsiCqqcwkrwldZfXOFAx5iiqnKLCQVZ9W2ygq5wOHYipgNsMKip9ONJYYzJSsQTcLzfQSExesDhyGlKKBB9RvxYUU9rQ0zT+Y3S0M9aBLDGXG4T2dHeLCrLl/I2tVy1jdFz80jWY9Qb6cld5UhJSKQFQObv/lZqN1qcB3qBLuPa4/C+5m4rmqAsbYZa76M0erYiBJx2WgqjpLmNCBAAAOXLoQKI+Y7OeSkpaHz1ZoCkfUg94ScvgqTx1yWI7DaE5zbjOpdI14D4T6Bme+pjI9WkDk2tONMSM5S3hdqav1K3ov+a6vgxONOFKD85+JA1tML+0qeXq1UInetHYijGw9Zq35HwJoeXFlClIoBIAvaJ2TTlZiGO+NgslI+lsyKfpPuLZs0CnvgHVUtL7nH7l09+ceTJfWo97daDAD9+1QRrmp7Be7Vty9puDyrAM/B5UCxCmz6t6oKzH2a5Ybvc4Az24IIhQAAJXU7r88TZ1aQ6ekh16iEC8yT9UwLdNyQJvR4RzF6DzIJpR4akWHIRgPJMsvmhivY4IoTP1HhB/YmiHcGlGZb9Fb7mTm4PwfSYLYE+Ugkh699zhRGz9mft/+x10xYQHt9uzmY6PeR1leDf4mcr8F2baUXPb3prfx6rVzDHhJEUviOzEoPWCM1LRVttEPeygN34XaV0s0Xqji+peXieMPUoSXEUX4ceE7gKhSDPLeKfup6eorYm8o8P2ml7kh+mZbRsJV4DBoUnLSIdn44JPIDEoV7TgEVRqNjGZzpsKfwLsekvnbhKyvNPhaQW8zBajhWSBJUf0493UeMO0saU4cPnAhCPgZwT8AA2Jq5WEYQihroz1KJcB0NWfN/Ks4juMCB99JMJP1vhPNbSsEOBpC0taYkgJ0FYHZgh/z0glaSKg57rBo/3FnMWJj/hV7Rn5gAAuKe7pGRFNLw6A+dnKREjgYSCnBUbxBqXmPUI0TRTxjckAz/4sWJED690WoJN8TaL/O6AxeFnJsV2eMzaEc/SjtpXYpucDRCjOTrpCB+OOB03H2SEWSraOtnXQ+vL2RelotcBzOTpWRDj7X8mSGg3ROUG77neVMIgBPBZPThXHkI7q7eqGUacd5LvmoO11/uwqG2eNTqC6F5dmyOZbpCNDEwkz7Mg3OpofLu2je5HRnqNBmAAHzKQiNKAW+bxs3n56hB/2S9gifCbd5QbkffDG4shLbBsn2PdQVeTVcuTeknJeFwmTyI0+7r5FgpQmPATnoz7LsSno6JwGYAVUVFMyCeg+/hkqpefYI979Fa3Xw2riupPZWaipwdlBau9pLJZJ2S7fbs61/AigDCgA9UreGb0Md8F6PDy5I4Ak6Hv2pTSmta1Xo6EH06NzY6XP/W0C935OzM+eKej4tQnQLAvetIM2/vdHb9/ojqDaLpV96CmZE0QzAohIIEvpR87LRSEC0I7kuqFadAdnBcJR+WJIxWJEo3OD5lhl8t29ACRmAJ75SWxpHjFzABwNMQxKIDWhvOypKc7X9UnGGbbFOkQxokRTuUrm1GyGVZ99hZ2rOuIRmCRbtN6ThrdX4YtbjAFwS1ky3Lp79XKKRj/88Fz6lC0ParpgDfRwgkCkPW5huEL+FbZu4OECtWMdWJvqt4Qt8u+GB7O0enVnYCdSUVJsKRGPUXKB7oAAuE+Gcd/Iu12pI5jwwAAAAAK89b0ui+Pbycz5tG+32kbMajvTmbqRPSlphoCmrYP2W+E19Mg7ad6TMZ/m2w4EShXlyIDZG4Kf5YGwyM3c6PCpfWTZKzEI1Xkk0uVhgZYV+7KCgbi5/qrC3EvBUMSqEs7lcfZBjHDYXiGbTdFMrcA/3ZFHY3t4eJ9lFuPQvp1mC3AvUK2rjXDsABK5tSATqMBfWLkcIs6Q3kSp2xdAtnlm0eC4GA3137OVkuQLBUea2/hTSBCPQteUgiFEkefMPLioGjJeqO2c9iPhj/ZLix7rWSQpkLVHHH7zW+kFzz9r+slMXRqPg1H2jkrm8rI7haTRxuk2Z3vQvj8UHHJC7TrTs1rTH5WOzpPK5O5EiIHVnpsRzk1Ccr4vbkjTpV4F/1WUMPuWfS+4XS+aukqrGKUsUsuBTynGxfF8lF52aTZ2nyJJRUp+FlMUlWS5DxatkeCxD8k3YKMz8RZOMmvGRyVgAeBR4EMQ98oMfWZUeBiII3SZ+oGSCY0zdpBU7CRdX7wrHckPLyhnoq7Wdo8OPEMnBucMuL5eIJwc3UhkVh4+klRtQeewQegdGPXBX37bw+N+bzfjoYKKcd5oCQEa5PHdoUn8x+vhkvCwFlm1ZncqE/jSIv7/qgHzhzROssgLx1fm49snyqTEbtclES/06ZSIuLJiw+hv/2IgUxvptjnXJczbwEhh+t75jSiOrbfzgNpJHCSJMSvhofc82tsqPd46qI8bC3zUz6Dn8N2BxKcLEcwGgcEiWmin2zkmMJojs2LjZlv9H3bbYZYTA/bP/enRTaoN3vLv/3D247kaRBsKCgnYrNto+lIN1hrL8lsd0k2EAjxb9uBPtQ7TWkklAtlKmvum5YeFRubmi3dMg2iYBFid/rgznC4fgnli1fIFUrg+N370YSTFx8v46XMT1GB8og21qmsBstfZh+euStOdLhOgmQoPlxpFgZ5teJmUYa/apM6l4563UKULJNTsQod71+TL1ekvH8OJvXV+HquKiYKhaZ+wiVc7gCf/kaPBADn7e+fMUfNpkE+kBUWrlnpbaLwKJmHe7kiGf/L7FIRq0wGk/NVJjFkkXyI0yD7rTf2Awsq/mhwhGCAE7GVQuREXdOP8yByOkbxutUeS18Aafq8AtsSjmjVp5qyR9dzE9xLzXlmesSTciywNtmabp13i6h6k063oiMtprkrZQvwBaA1GMnHjgEZvDMJSkRtSCdvPBM95wwSdqNxFsQf364QzuowokwtvrJmNVL5OUTLCdVCn0wd+f3E4vc74bVA+Gnv7890ZftT78oYXOMy1I66fZVOTCYxfQoprazGfbQAElvMrtLQ2CPea8YTfS1w8c/7+FdwNSdPJtkyNGb29Q5q23O0Z1z6B80afzEe6Zbn5XK7q8X6ljpc21wo1VQ2a5X9E+D8+ZnMdfW8bzRzXXarBX+F+79AZxs56rFa9uH1JeHErvn3hcBotOq7MrbxWmVHOo0+XTq8+K4YWgZpcmIIxBeb/BE5vlFFepaPdEA/y5mGTUmAF1qoOv7hQCQLqsB3U3yb6pdpFgcrjMEdSNexNh/HIYRa1wjlLtGAbDwrnVXABwRoFBiD/bUg0ybgtpa1ByutwtrmmICyTBYGJyUSJ0eFSg5Ku3+9vUpFNz7YV4mFqZX3SEyZv1OnxNBZQR5UuY64/Gh6evVPx3Blnw9kf1Oi/SESIb9vUNQ5UfyZHelZbcdqRuAb6bR4bdw2OLe2AdCKDcvp5ic6M+MoI2/ID9e58AjHXY4NgiA5vnJ7Cto8aVJEns49yvpxkWw5FIn5T75mbExGmmw0QHSlwDzksZ7ydKepTpYHsMkFnKeY5N3qVh6TczWl01DoI+4Jvs1499W1VvPAZ1EBuxEBGWys7HhbvCumPbwxAqD/ufDYLBXeUeN8/NvfPmKVtppkQPwKcfF/kLN3/R1ZNVxeQEbr6wyjqCI1yh9slGw4wqaEtLhcGUA7Sa5+PrNQUxnK26o7oS8rJcjZZZ0s1gzKb//Za7NrIYD8WutkUrPORK3Ab3KBB+JRwymg1I+i4hzt8UcuiHC6LhaHUwkqkqa6Geq2du8MmmtXyTtGaNjSR0NJkhq/HYSEIhDCmIGm06FkeUh1KFXkPDH5GqWWzPTnXkrllm7rg5VreGzPvMXNBvSqoaZqyvDVIL7A0E3uu3inbPAIXM7Jp5g1nWm30Gql8QfHkAC0dWIkqUNVF2IdNuIcLFmbmXw9C9VrFqXYvpTpwCcLz850DjpVIFPUkKqZmXLwXXqNcyovVZCcpu4z/k4qDtdYXNC9Pvypr8M1U7R1GPU5HK4HiJXVxbPQ4B89Q9ZQLEzt5VmWicZ4rhfAb8LbH25qqGY8RpG0U1X4z/7CnOqBoX4wl/nBxSomLqb9Y5gWtldtrbWy7TH8grMza9q9S+eCy8xFDtBSk62Ga5EII2cTApzhclQDZsX0Lq3x0/NvTaTzF1KxZEtQ9OZrJApZ1vXY6kBKEGRj7/MLy3jZeMZUhxrQ+ovnzHILhiLwy9D5O8If5n16LPgDnQ1v2ICRvVuPzd9Z7eAHh6kb2ogetGjggsunBpUA0VepebtQlVIFGnraGX+kBJP3qfa1zw/YmtO4WtVxX9THfT6t7Las8e0pWu5OgVGmEFNh+1PihPLeWmHM0KR9DgyakOvfKk4cojMVUh16PXp6p82dke7UNzjaHSIOSUklfhr8Ofe6Afo8+pDNLIELS05+9k8ut/NL4gEg6twbndQawycoaMlBfz10AZMjyZyJZ6NFr0311LtJoq4hOpPgcmjpKifYENDr9fyGf/l73P/FnWJVTNoaVxIPlORyuESn5cbQ63ul9bMhGR3a0bV2Iq1W3eqcTw9yofYHHnxEBH3q9qhvK5kTps6Y3bh+WwfZN09gjXWgbp2DguBGgIeFG68eiZ2C/NrQfuM+9/bGsXecrq7T1SSWImcYx2/tcee4rJ3AYoqjJ/t6bqhqJimZW+hMV7zdnQnrX8lkZOjJMtaKG6wXbXmtnMlizPtIe52XiLkGjJFKaJBC5wMHpm2Zwv+VGyRsmmGfQb/hJjxeDhqYrTdpcZ66XOr4APcmbE2UFtzXZHOAyaD7raKId1MrAZnDWtYbKGSSM04UilIKuRot+tKPMiULOrH7c1j3gCeK30+pR2WCEb9+RAy5Rh5rUAz+xapbVyXoBMt4iCgL5UmI/8wpcA0jI3Mq2fUsVQstoJvbaarzYsN5bvCD/E3r3nlTsrYjJRi/g/Coh/D5LOUwvGUUk43ocH475yt3rt7rsRKgFbrR7NOZqypr+AgXBreUDl5ImGooS4uAHHVejICs3fzUPeOVsWU8PV2A9NSx3bF41qVkfH5TEv0US6LaRJ1T6zVnByIQ+YHnGU8IoBNbY6ISTRmX4Ui+J3CI4S3Jey0cHed7tV1/yXAap7HuRGjNBN7NSDnfiWz+wWVCHgAU6LE1zDV24AmO4yYRf1oJL2DuZcwwa+WGSGvOg4LQDK/psDocX8VetFFhIoYAx6fMJnI+cbRqkyBBDlznxuAVplZTqxeJzWIq6RJb7Ofmp4DDzjO26yeBOsAtMCwrWJkUPW5CKEOeJ1nxXlsRpGL6BiVZOXOfIh5dw4/i4nPCFO5/sChsiLPTvfRLRinjnKxiWH/PJj9hKgiwixQ3fDQzLD8zdYQwO6aj858HUL5N9+oRizGj0N9HYdnHuAHwq5mJOYprQR8P7lYc3MaAfGvxJeJ254V5VjxVHTX1mIy0TsTtodiRVDgh/T0QemIdKV7CNAIueGgdJfva8TudUx0gqDiGDoESsRY3Moqt3Nv5ca7CQktYd8kVe3XhQq0G3ZfeIEK1gHcgf28PVM3VHjoc8TbCI102IhvPlluRY32O6wGJp5+pzgldnGgThC8aCY4PncfjXhX615PSm+sRmwHh9KJdQlyO45nlTX/Bx82WW2mz/C/3HaPH4vy9oQlYEJK9NnwkMicAOJFmAIT0BAVWCHp2ZECorW15cDPh18SEvEUz5nmHREoM2GTCUknju67JzR7Rvobj0/4IBXHsvCK6gpYzQKHYXQvQAxEKvw/UpSNLcTusvShDcxmHq7UtJUzA491qkFEBLArjJLFJ3EMRpRpytKxpRL9h2xPWaj2k75Bb5g/55dk7uZRA4tPR53W96VTL5mDXuWxPrmMWWdV3s2I0AO53e2j0KsnkbLywyjGhbyLzHhr71KNjDKu8Y1556XhzPKJYISmESkyd6eVUKsAGNBPj5pX17mSujMkNvkghiCdwbTncbpCRFl8Ob80UYKcB4YOWK6Nb48f1EmYahNK+w8bgB2M1t91h8eXiNKqOxdNlmQx5cl+/g+j6RTJCDEDnLWCzc+2Y6aOjKIgZg6s/1eMKXf0LwojLENimpVCnGWMMc5yO+cRVdwT9ryhr/fY0vyEu7vKEj9EWfdDSX3ENOHeKEmwtdTbyHDREUrak0gUByzZTgg4IVFTQd+nuH4+1eLcIHQQ3/iR9wnf/zbShWSNVjnhqtoRDfqQZZnLzPFqdoVToc5RiDzguK5SAqSNHcquJG0JabCP3g8nAiBR7D/jB2ts9y2/Othtm1EvSoUDUJM6XV1zo43kPOzPLkyTt+SEU9hF2iSEggQKWkKU6Bnveoqq187rlzhzB1v8r++9vW6jbYgv+4tm9JJZZUi/ta8RTVSUvV8HS6lr/hjkp3a9NvzT+3ezIq5odW85mRLyCl0TfbqkLDPhm7fmdu8w/Z0wmCgZL1CWCAq/w8V3FqbOSwYThw4rGDwnkbO0kNYireh4T/+beo23rya9GX35UVH5NMySwUe6DmndOsuMCH0YYmQjXt4bBMSg4p7tcy1LT3ivXAsZiRSLFVwsBcerE5IUL4NFQlaj/m3l3uLzPPNSfbYhekzKpnxVLk25y2Bsg//DAGulq2ejjfe3/o69sh9GClP/gzAduu0L4sLUSRV/INlFvyluR0JeTr1lB4DanEVsMSAfQO6q1yo/cWUx9oOEQrLeFF9ldTg45s/xSNqw9xLCgavS/+eD3TLhYaiy94TUylr/CSr5BAsXQmMgsXe20mxP9ffIbgud//sC96aoK2zaA7O2w6Hcidaf1f9no2v4Uvs0TftjPN9cAGA92gzqs5YvpOg8K/a52Zngw5YECq/wgy+rDv2MN0d+qbNpQRASTxT/6ihaUYmaHrSwvm+Ec1fcDhfFX4mxfD2JGj+SwT70Cqz5bGqCIk/8ptAlxw9HLIm1qBle4r/7IKgA8b+lBaf+0xq4k2QHMDNHKpKsygpwARpt6+/ll5kV6NmLXsB0i3uAWTO7cAsgszDjsKm4865SkabLPiL6u74vefhQ82Ug5obvv1Z+hHKDhRaSu9g8jvsqD1qATdnRTZLWT2y6r0lGAa4wwW8SHzN75CQU3Y3u0yIF7cAwskyKIU79S08rfhnmOR+nCyIOg8362lr151uqPJ20jDBBsgJlcfr1kViVtb8kPKSOxevKAWwmtcq2BjiKYcBtFaaQT/Ne43ipV7g1JvNEqGORrf44u0w35/oH/f/hgUk2GBtjXDKE3wcc6+/FzcE6fvHFecFnl8SmVLBcBuDEGl/VHNcQoWgKTjyKELnj0UJXwqIWqj6jG+rTn828pD22F58zM5+zh0iN86nTpEF1no2NMYht9F9VbLgcXYXySKraSjUoXIyxGe4glTgtdqLssqNQPyocws5/P2NZbw8U5d+MkO455I8TRZVmvrXyctos3WnKWyge3xDdp9IPLFWO8dMBj/9VXOSogm4bjnrgFJzTGcFsPl9PNtrN4+QLw6FN34t7yAE+3ArfQ9M0ZCsnSn27ROav7qdLRUR143NSTbX7J1QQmPa/nkw9LVE7+mP0zBT6I8UWtwCkaYLZJLREvv4t2a/+c2pC000g6Cn7xRp9mq+z8eygsOwNOHgdYc6rghTzj2cJMldTlyLmC/keiU5TwX+B7qbGueymbuSyECLhzNAngOKpnZvAdPzLcvtibejw0ttLuSOB+CIGSBc6/MsXw6Z7gCUP6aWy3KNvDCQszg+amZip/ShbJ7BGx0JIgXIyOq2HeuIQOP3sMUfE1sQkoqG999C1ZFtP91P7YtfTTZscZ3uPUq24Y6oQwMCg/1uVhC5DGnxphQqxLk54ub+28iK8UXgBn82RROLV4NiAvzkUglLqgAno3TjIAT6P2zUz2MSGirdrCHW30tlAnDB+b80O/o/18Gt9coD46qxH+FE2P1Ld5HtUfmCez6UhOHWSkYq7FfftftRJEVoCrQrWNoDa67vP4uMT7ltNzQxc1EvFOUw5aCL+TQ4e7GCcFa692LzOTMBIHz9u/s8ND1XwFAwk3bwLUKZfrdV/df8//7TzSMQlUQAaUxFxpcbD+Rqt5qaoi8ygBhbvD/ienYbsJkfh7/MEDioVdeoStkT0byYzM/qj1Y9Y5du16/QDh32ZXaGxFGAG/yfBjPFrJ5CXOHsCyKcNP+ZABf6WArOiYdz0wcysKynl7RAxA8s/ZDJsBkZEtC09iGKWthTyzlnVdqldTNR4kczlwJwWUY97JBe2K68xk2RIMm3g/RoO/wEj4zu3tmd1PLzV2ZVjZ181hz0E9LF6tdSx4VakNBG7+8nAQgaV2s64JliY17OOK96bhmLYKHgzb/NttUjidAbjobUPCmy5B7aNHafhpoFk8WLlOQ9+XKzMhmC1yVfDr0gh5Gk4Tt2dcehT/kXrDoJqWHtvmGVCJgZKEV07sijR9CenSHhXtvRjbwUxnJdffKprSrHYkyPRpHF0J125xam61eTCNfxWIVAW6c3qnQ7oe6WAbx6JC3MVAOOr22/3KNWtw5Hvuz6ddWVeqA6mYbxTi2Liht1nsSvhIjSn0/6l/PwRxSH/6/H1K31SdwTp7S8ni0N3mZEGbjNAa8UHIKzpqCPntO71z1juhBjIHOuB+59QUvvCIzsJ5mu+X0fblrzH83g5mEXtmZBZ6ovzjujUbI3lTodv8XVITJW/6txRGyI+M8lFZ46Vs7m/YSzZQx69srvodBTHG0LKCBak7fxSPKT1MFkQ91VvG1GSilAxslZgd7X5IFP0rJlRfOYNE8+MswyCbgfev+h2bwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==" id="favicon">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        // Logo EcomLik - À remplacer par votre URL d'hébergement
        const ECOMLIK_LOGO = 'data:image/webp;base64,UklGRl4lAABXRUJQVlA4WAoAAAAgAAAAfwIAfwIASUNDUMgBAAAAAAHIAAAAAAQwAABtbnRyUkdCIFhZWiAH4AABAAEAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAACRyWFlaAAABFAAAABRnWFlaAAABKAAAABRiWFlaAAABPAAAABR3dHB0AAABUAAAABRyVFJDAAABZAAAAChnVFJDAAABZAAAAChiVFJDAAABZAAAAChjcHJ0AAABjAAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAAgAAAAcAHMAUgBHAEJYWVogAAAAAAAAb6IAADj1AAADkFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAACSgAAAPhAAAts9YWVogAAAAAAAA9tYAAQAAAADTLXBhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABtbHVjAAAAAAAAAAEAAAAMZW5VUwAAACAAAAAcAEcAbwBvAGcAbABlACAASQBuAGMALgAgADIAMAAxADZWUDggcCMAANDfAJ0BKoACgAI+USiSRiOkoaEkNJhIkAoJZ27hdY5kcAOFbfH1x8afS/mP7TVqfuP4Y/u/zcfyu6jsjy4PJ/1r/Zf4L8jfm9/xvWn+hv+r7i/6n/6r/Df5L9nfjW9eXmx/cT9zPbR6ST/udfB6Vnmm/9L9xPiX/ZD9nfad1PV7v+U/z/iz5g/bPth+7n2N4o/lvA/+cfeb9V/hf3E/Mn8Dfef4u8Aj8q/nv+X/sn7gfmdzHABfzj+2/8n0yvw/Q37R/8TztfYnxtKBX6K9IrU+9a/+z2Of7p/xBA1cOq27gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7f6jmkiXyCpza7gDm4ZfIKnNraVr7aF64O+wqjKvaiXtRL2ol7US60W/Pc3/UJR4dVt3AHNwy+QVOGn+uGgM7LoRy7SSBJmg7A7pOqyDLqRL5BU5tdwBzcMavZ171JbC34LVT74cBVSPuuZBhhbGgFsnDAmPcoWi/m5r/KqYje4dVt3AHNwy+QUV3Q7JXuCiUvdYPjYJNG1eZGBoLc8liN7fHoQ4K0siUzTR/HzIAh7R0c3DL5BU5tdwBzRT4espWY1N5oob2qcTl4jgC3+baBCP//BWKLKtu4A5uGXyCpza7gCyR4Tv9iffUhhoqNol/qKw1wiyWvGReluI/PEWIXrcoXDqtu4A5uGXyCpMp9wGSF75HqJxPj4Fe7c+v0Sa7zvUM2u4A5uGXyCpza7gDjA5UJO6k3itPmH2ERN/RWOXA3uw8sX9P/65bB8Jl0wHNwy+QVObXcAc3DVyufYnAIXhU9hGv6GUr9y76hl4ceR5VqkS+QVObXcAc3DL5BU7W0srr4JodkBn+QgtpJNrxboI3cAc3DL5BU5tdwBzcMxXxX2gHWlazWztuJ0hJ//8TMxBgBzcMvkFTm12/0MD3fNJGTI+Htdo8SrEhPVFfLCZ2tOVw6rbuAU9WdutJyiPUim00AplYFbMLV1KgPoY+ooRFXc1B820fUstEkL4OV7wnGhfTTfQH5xinWkBpgObhl7qZD0dP7EHXOOXoPafFIJDfiRAFD/eviFpnqjXRwjkYtFWi9c+VkQZUy6+85Diau+RWEEYTbIcrVi8XseW86krU+DhfQMtPKdlNYg+T+9priokvPl10DD8IX0GlBsPDeqVl0grzeA/VSBJ3AHNwy4KvDMEMjeTcFGTLLPJFy2KuzP58Uy8VkzxCddx6OlVtDI6jNS6feWQEXVkQejrJ+OEpS8h7hnVyBPqPKQsR+5kvOfrRZy4nS8oVRjuad6mz4k/7saX38sLNruAObhjekUqiPeu1PPU2lyp/rDGfZE5/PnWVMkyMdw/6xW/QtR/2u2JZKEKePdyZy6n9A/PfdEx1AMpO7v3pV/vycxmLff3/2fe5oQHmaT9dQpES0f/E/rqrlu+D3GP833W6H1xs3DL5BU8fkUhp5GqQSOJK75qVxbYAtv4oBlMH1brEZLb+3kszmh8DB5eN3nz1hcTTPxEbMsjBycMTd0N8i2cKjXMLwBP0MRqIaMrvsZHnHm8hFTTTX9XyXt+NXM8toq3QkS+QVOZqpHYBY5CoHNvp99DTxW3hRxJvUZwbZtZ2HC1wFxXS/SACvAvq/9b7YhxYdvXPwHUkyaM3VVvyWvfrU/fbPn2RcLn1HuAbWEJd2Z1GcnwP22AftnlQL+cr2pvJxz9e7VGcD05pIl8gUDKFNzSQdAnMO9x+9OG1crGg8MUCZNDLk9XkxRg4no4m+MXJSNrHRAgsEmTTatM4ANieVDrfEOWzrg9xLAYzaiIfxgHoaHctoIOyRUaNeRz8e44t9n9q3lamop9OrOwkmSrRv1V2kVPzQXBVrXrZhgYgR+66XuSgtR0MHzmergKOzCpQx2WrtSTeRL5BU5tALEyII2QyVMbIrwVfmurvUxCIQ8pQ/zAAbLUIy5DVn77NWA6CpVN/8AhfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqcygAP7/xLAAAAAAAAAAAAAAAAHhgBEbys1Bjv5GTjFRkjfKaiafjQ3UjRwIwpTYRO4fQzB3pTE75RAOfolmT8NPj7aq2aB1XOaIGlThu16sEdj2rjiHQovaCoketM4kO9OyoYaIVWJOjp3qrh0et5XlS4Oejg5CBhiTjpatIpyGtyd0zfEgOgPVzwPXTmN4A410DeJ2NTIviPQVEUlOcFCi+pU2B/y8QsQkwLvMhNgEGmBP/PRKT39FoyTvq8Q6T4TR7SaK8u8x93LamRSfZCTVvUd37IBUrXASeXNWkZy++4uCHXIFB5NzBrCEXnapjh6KUJ2xGmSI9SXZT9dtRkwPhdSKG3IvtKVIEpJ4xwjIhaxIK1O+xuJBg5n0l24Il36KP/KXszRvDL+KhQHCUOQrLjEu6j4pOLH5A5xWf6pRdlkpwvZiYmliP2O0JNvBVWUp7WWJ1UJY6TkWtB4I0oA9vh6XiVH5A6uOKoNB0nClMxbnSjpY4C1bzhPJSRuD68G/iuxmjxXpz+DLV/SjwharFVRufM+oQwGzJTs4RG0yTFbgl+pBHmhoJGlUXBHtLAIvKrZqzzyY0L342U87Bv6ZWjxBaro6YLSGtfj4aSHZ9vOYAwpMZvunhSu5q4iGcbl8g0S+5RlQMptyAq64BFlCv8JhOq/WDqfyha3ZJC+g06YG3mBf/qedJPC6azG626evy8H7bxDPeo/SnqqQDActvSjr+310gzCIYhNIU3bN/w1BGTnSFRZZup+4Y1nD1yTdpMYfYSS0XQbq0Q0A6zn+WadP9Ap5AaS3yXBUYov6ZaGCnaBI25g20g5TJTZvU5OczEOsLfxeUXLTm8P/bhhJPRnI6YSCRieOcSf/32rFVlWgskGc88bPR13SQHQAtsiCqqcwkrwldZfXOFAx5iiqnKLCQVZ9W2ygq5wOHYipgNsMKip9ONJYYzJSsQTcLzfQSExesDhyGlKKBB9RvxYUU9rQ0zT+Y3S0M9aBLDGXG4T2dHeLCrLl/I2tVy1jdFz80jWY9Qb6cld5UhJSKQFQObv/lZqN1qcB3qBLuPa4/C+5m4rmqAsbYZa76M0erYiBJx2WgqjpLmNCBAAAOXLoQKI+Y7OeSkpaHz1ZoCkfUg94ScvgqTx1yWI7DaE5zbjOpdI14D4T6Bme+pjI9WkDk2tONMSM5S3hdqav1K3ov+a6vgxONOFKD85+JA1tML+0qeXq1UInetHYijGw9Zq35HwJoeXFlClIoBIAvaJ2TTlZiGO+NgslI+lsyKfpPuLZs0CnvgHVUtL7nH7l09+ceTJfWo97daDAD9+1QRrmp7Be7Vty9puDyrAM/B5UCxCmz6t6oKzH2a5Ybvc4Az24IIhQAAJXU7r88TZ1aQ6ekh16iEC8yT9UwLdNyQJvR4RzF6DzIJpR4akWHIRgPJMsvmhivY4IoTP1HhB/YmiHcGlGZb9Fb7mTm4PwfSYLYE+Ugkh699zhRGz9mft/+x10xYQHt9uzmY6PeR1leDf4mcr8F2baUXPb3prfx6rVzDHhJEUviOzEoPWCM1LRVttEPeygN34XaV0s0Xqji+peXieMPUoSXEUX4ceE7gKhSDPLeKfup6eorYm8o8P2ml7kh+mZbRsJV4DBoUnLSIdn44JPIDEoV7TgEVRqNjGZzpsKfwLsekvnbhKyvNPhaQW8zBajhWSBJUf0493UeMO0saU4cPnAhCPgZwT8AA2Jq5WEYQihroz1KJcB0NWfN/Ks4juMCB99JMJP1vhPNbSsEOBpC0taYkgJ0FYHZgh/z0glaSKg57rBo/3FnMWJj/hV7Rn5gAAuKe7pGRFNLw6A+dnKREjgYSCnBUbxBqXmPUI0TRTxjckAz/4sWJED690WoJN8TaL/O6AxeFnJsV2eMzaEc/SjtpXYpucDRCjOTrpCB+OOB03H2SEWSraOtnXQ+vL2RelotcBzOTpWRDj7X8mSGg3ROUG77neVMIgBPBZPThXHkI7q7eqGUacd5LvmoO11/uwqG2eNTqC6F5dmyOZbpCNDEwkz7Mg3OpofLu2je5HRnqNBmAAHzKQiNKAW+bxs3n56hB/2S9gifCbd5QbkffDG4shLbBsn2PdQVeTVcuTeknJeFwmTyI0+7r5FgpQmPATnoz7LsSno6JwGYAVUVFMyCeg+/hkqpefYI979Fa3Xw2riupPZWaipwdlBau9pLJZJ2S7fbs61/AigDCgA9UreGb0Md8F6PDy5I4Ak6Hv2pTSmta1Xo6EH06NzY6XP/W0C935OzM+eKej4tQnQLAvetIM2/vdHb9/ojqDaLpV96CmZE0QzAohIIEvpR87LRSEC0I7kuqFadAdnBcJR+WJIxWJEo3OD5lhl8t29ACRmAJ75SWxpHjFzABwNMQxKIDWhvOypKc7X9UnGGbbFOkQxokRTuUrm1GyGVZ99hZ2rOuIRmCRbtN6ThrdX4YtbjAFwS1ky3Lp79XKKRj/88Fz6lC0ParpgDfRwgkCkPW5huEL+FbZu4OECtWMdWJvqt4Qt8u+GB7O0enVnYCdSUVJsKRGPUXKB7oAAuE+Gcd/Iu12pI5jwwAAAAAK89b0ui+Pbycz5tG+32kbMajvTmbqRPSlphoCmrYP2W+E19Mg7ad6TMZ/m2w4EShXlyIDZG4Kf5YGwyM3c6PCpfWTZKzEI1Xkk0uVhgZYV+7KCgbi5/qrC3EvBUMSqEs7lcfZBjHDYXiGbTdFMrcA/3ZFHY3t4eJ9lFuPQvp1mC3AvUK2rjXDsABK5tSATqMBfWLkcIs6Q3kSp2xdAtnlm0eC4GA3137OVkuQLBUea2/hTSBCPQteUgiFEkefMPLioGjJeqO2c9iPhj/ZLix7rWSQpkLVHHH7zW+kFzz9r+slMXRqPg1H2jkrm8rI7haTRxuk2Z3vQvj8UHHJC7TrTs1rTH5WOzpPK5O5EiIHVnpsRzk1Ccr4vbkjTpV4F/1WUMPuWfS+4XS+aukqrGKUsUsuBTynGxfF8lF52aTZ2nyJJRUp+FlMUlWS5DxatkeCxD8k3YKMz8RZOMmvGRyVgAeBR4EMQ98oMfWZUeBiII3SZ+oGSCY0zdpBU7CRdX7wrHckPLyhnoq7Wdo8OPEMnBucMuL5eIJwc3UhkVh4+klRtQeewQegdGPXBX37bw+N+bzfjoYKKcd5oCQEa5PHdoUn8x+vhkvCwFlm1ZncqE/jSIv7/qgHzhzROssgLx1fm49snyqTEbtclES/06ZSIuLJiw+hv/2IgUxvptjnXJczbwEhh+t75jSiOrbfzgNpJHCSJMSvhofc82tsqPd46qI8bC3zUz6Dn8N2BxKcLEcwGgcEiWmin2zkmMJojs2LjZlv9H3bbYZYTA/bP/enRTaoN3vLv/3D247kaRBsKCgnYrNto+lIN1hrL8lsd0k2EAjxb9uBPtQ7TWkklAtlKmvum5YeFRubmi3dMg2iYBFid/rgznC4fgnli1fIFUrg+N370YSTFx8v46XMT1GB8og21qmsBstfZh+euStOdLhOgmQoPlxpFgZ5teJmUYa/apM6l4563UKULJNTsQod71+TL1ekvH8OJvXV+HquKiYKhaZ+wiVc7gCf/kaPBADn7e+fMUfNpkE+kBUWrlnpbaLwKJmHe7kiGf/L7FIRq0wGk/NVJjFkkXyI0yD7rTf2Awsq/mhwhGCAE7GVQuREXdOP8yByOkbxutUeS18Aafq8AtsSjmjVp5qyR9dzE9xLzXlmesSTciywNtmabp13i6h6k063oiMtprkrZQvwBaA1GMnHjgEZvDMJSkRtSCdvPBM95wwSdqNxFsQf364QzuowokwtvrJmNVL5OUTLCdVCn0wd+f3E4vc74bVA+Gnv7890ZftT78oYXOMy1I66fZVOTCYxfQoprazGfbQAElvMrtLQ2CPea8YTfS1w8c/7+FdwNSdPJtkyNGb29Q5q23O0Z1z6B80afzEe6Zbn5XK7q8X6ljpc21wo1VQ2a5X9E+D8+ZnMdfW8bzRzXXarBX+F+79AZxs56rFa9uH1JeHErvn3hcBotOq7MrbxWmVHOo0+XTq8+K4YWgZpcmIIxBeb/BE5vlFFepaPdEA/y5mGTUmAF1qoOv7hQCQLqsB3U3yb6pdpFgcrjMEdSNexNh/HIYRa1wjlLtGAbDwrnVXABwRoFBiD/bUg0ybgtpa1ByutwtrmmICyTBYGJyUSJ0eFSg5Ku3+9vUpFNz7YV4mFqZX3SEyZv1OnxNBZQR5UuY64/Gh6evVPx3Blnw9kf1Oi/SESIb9vUNQ5UfyZHelZbcdqRuAb6bR4bdw2OLe2AdCKDcvp5ic6M+MoI2/ID9e58AjHXY4NgiA5vnJ7Cto8aVJEns49yvpxkWw5FIn5T75mbExGmmw0QHSlwDzksZ7ydKepTpYHsMkFnKeY5N3qVh6TczWl01DoI+4Jvs1499W1VvPAZ1EBuxEBGWys7HhbvCumPbwxAqD/ufDYLBXeUeN8/NvfPmKVtppkQPwKcfF/kLN3/R1ZNVxeQEbr6wyjqCI1yh9slGw4wqaEtLhcGUA7Sa5+PrNQUxnK26o7oS8rJcjZZZ0s1gzKb//Za7NrIYD8WutkUrPORK3Ab3KBB+JRwymg1I+i4hzt8UcuiHC6LhaHUwkqkqa6Geq2du8MmmtXyTtGaNjSR0NJkhq/HYSEIhDCmIGm06FkeUh1KFXkPDH5GqWWzPTnXkrllm7rg5VreGzPvMXNBvSqoaZqyvDVIL7A0E3uu3inbPAIXM7Jp5g1nWm30Gql8QfHkAC0dWIkqUNVF2IdNuIcLFmbmXw9C9VrFqXYvpTpwCcLz850DjpVIFPUkKqZmXLwXXqNcyovVZCcpu4z/k4qDtdYXNC9Pvypr8M1U7R1GPU5HK4HiJXVxbPQ4B89Q9ZQLEzt5VmWicZ4rhfAb8LbH25qqGY8RpG0U1X4z/7CnOqBoX4wl/nBxSomLqb9Y5gWtldtrbWy7TH8grMza9q9S+eCy8xFDtBSk62Ga5EII2cTApzhclQDZsX0Lq3x0/NvTaTzF1KxZEtQ9OZrJApZ1vXY6kBKEGRj7/MLy3jZeMZUhxrQ+ovnzHILhiLwy9D5O8If5n16LPgDnQ1v2ICRvVuPzd9Z7eAHh6kb2ogetGjggsunBpUA0VepebtQlVIFGnraGX+kBJP3qfa1zw/YmtO4WtVxX9THfT6t7Las8e0pWu5OgVGmEFNh+1PihPLeWmHM0KR9DgyakOvfKk4cojMVUh16PXp6p82dke7UNzjaHSIOSUklfhr8Ofe6Afo8+pDNLIELS05+9k8ut/NL4gEg6twbndQawycoaMlBfz10AZMjyZyJZ6NFr0311LtJoq4hOpPgcmjpKifYENDr9fyGf/l73P/FnWJVTNoaVxIPlORyuESn5cbQ63ul9bMhGR3a0bV2Iq1W3eqcTw9yofYHHnxEBH3q9qhvK5kTps6Y3bh+WwfZN09gjXWgbp2DguBGgIeFG68eiZ2C/NrQfuM+9/bGsXecrq7T1SSWImcYx2/tcee4rJ3AYoqjJ/t6bqhqJimZW+hMV7zdnQnrX8lkZOjJMtaKG6wXbXmtnMlizPtIe52XiLkGjJFKaJBC5wMHpm2Zwv+VGyRsmmGfQb/hJjxeDhqYrTdpcZ66XOr4APcmbE2UFtzXZHOAyaD7raKId1MrAZnDWtYbKGSSM04UilIKuRot+tKPMiULOrH7c1j3gCeK30+pR2WCEb9+RAy5Rh5rUAz+xapbVyXoBMt4iCgL5UmI/8wpcA0jI3Mq2fUsVQstoJvbaarzYsN5bvCD/E3r3nlTsrYjJRi/g/Coh/D5LOUwvGUUk43ocH475yt3rt7rsRKgFbrR7NOZqypr+AgXBreUDl5ImGooS4uAHHVejICs3fzUPeOVsWU8PV2A9NSx3bF41qVkfH5TEv0US6LaRJ1T6zVnByIQ+YHnGU8IoBNbY6ISTRmX4Ui+J3CI4S3Jey0cHed7tV1/yXAap7HuRGjNBN7NSDnfiWz+wWVCHgAU6LE1zDV24AmO4yYRf1oJL2DuZcwwa+WGSGvOg4LQDK/psDocX8VetFFhIoYAx6fMJnI+cbRqkyBBDlznxuAVplZTqxeJzWIq6RJb7Ofmp4DDzjO26yeBOsAtMCwrWJkUPW5CKEOeJ1nxXlsRpGL6BiVZOXOfIh5dw4/i4nPCFO5/sChsiLPTvfRLRinjnKxiWH/PJj9hKgiwixQ3fDQzLD8zdYQwO6aj858HUL5N9+oRizGj0N9HYdnHuAHwq5mJOYprQR8P7lYc3MaAfGvxJeJ254V5VjxVHTX1mIy0TsTtodiRVDgh/T0QemIdKV7CNAIueGgdJfva8TudUx0gqDiGDoESsRY3Moqt3Nv5ca7CQktYd8kVe3XhQq0G3ZfeIEK1gHcgf28PVM3VHjoc8TbCI102IhvPlluRY32O6wGJp5+pzgldnGgThC8aCY4PncfjXhX615PSm+sRmwHh9KJdQlyO45nlTX/Bx82WW2mz/C/3HaPH4vy9oQlYEJK9NnwkMicAOJFmAIT0BAVWCHp2ZECorW15cDPh18SEvEUz5nmHREoM2GTCUknju67JzR7Rvobj0/4IBXHsvCK6gpYzQKHYXQvQAxEKvw/UpSNLcTusvShDcxmHq7UtJUzA491qkFEBLArjJLFJ3EMRpRpytKxpRL9h2xPWaj2k75Bb5g/55dk7uZRA4tPR53W96VTL5mDXuWxPrmMWWdV3s2I0AO53e2j0KsnkbLywyjGhbyLzHhr71KNjDKu8Y1556XhzPKJYISmESkyd6eVUKsAGNBPj5pX17mSujMkNvkghiCdwbTncbpCRFl8Ob80UYKcB4YOWK6Nb48f1EmYahNK+w8bgB2M1t91h8eXiNKqOxdNlmQx5cl+/g+j6RTJCDEDnLWCzc+2Y6aOjKIgZg6s/1eMKXf0LwojLENimpVCnGWMMc5yO+cRVdwT9ryhr/fY0vyEu7vKEj9EWfdDSX3ENOHeKEmwtdTbyHDREUrak0gUByzZTgg4IVFTQd+nuH4+1eLcIHQQ3/iR9wnf/zbShWSNVjnhqtoRDfqQZZnLzPFqdoVToc5RiDzguK5SAqSNHcquJG0JabCP3g8nAiBR7D/jB2ts9y2/Othtm1EvSoUDUJM6XV1zo43kPOzPLkyTt+SEU9hF2iSEggQKWkKU6Bnveoqq187rlzhzB1v8r++9vW6jbYgv+4tm9JJZZUi/ta8RTVSUvV8HS6lr/hjkp3a9NvzT+3ezIq5odW85mRLyCl0TfbqkLDPhm7fmdu8w/Z0wmCgZL1CWCAq/w8V3FqbOSwYThw4rGDwnkbO0kNYireh4T/+beo23rya9GX35UVH5NMySwUe6DmndOsuMCH0YYmQjXt4bBMSg4p7tcy1LT3ivXAsZiRSLFVwsBcerE5IUL4NFQlaj/m3l3uLzPPNSfbYhekzKpnxVLk25y2Bsg//DAGulq2ejjfe3/o69sh9GClP/gzAduu0L4sLUSRV/INlFvyluR0JeTr1lB4DanEVsMSAfQO6q1yo/cWUx9oOEQrLeFF9ldTg45s/xSNqw9xLCgavS/+eD3TLhYaiy94TUylr/CSr5BAsXQmMgsXe20mxP9ffIbgud//sC96aoK2zaA7O2w6Hcidaf1f9no2v4Uvs0TftjPN9cAGA92gzqs5YvpOg8K/a52Zngw5YECq/wgy+rDv2MN0d+qbNpQRASTxT/6ihaUYmaHrSwvm+Ec1fcDhfFX4mxfD2JGj+SwT70Cqz5bGqCIk/8ptAlxw9HLIm1qBle4r/7IKgA8b+lBaf+0xq4k2QHMDNHKpKsygpwARpt6+/ll5kV6NmLXsB0i3uAWTO7cAsgszDjsKm4865SkabLPiL6u74vefhQ82Ug5obvv1Z+hHKDhRaSu9g8jvsqD1qATdnRTZLWT2y6r0lGAa4wwW8SHzN75CQU3Y3u0yIF7cAwskyKIU79S08rfhnmOR+nCyIOg8362lr151uqPJ20jDBBsgJlcfr1kViVtb8kPKSOxevKAWwmtcq2BjiKYcBtFaaQT/Ne43ipV7g1JvNEqGORrf44u0w35/oH/f/hgUk2GBtjXDKE3wcc6+/FzcE6fvHFecFnl8SmVLBcBuDEGl/VHNcQoWgKTjyKELnj0UJXwqIWqj6jG+rTn828pD22F58zM5+zh0iN86nTpEF1no2NMYht9F9VbLgcXYXySKraSjUoXIyxGe4glTgtdqLssqNQPyocws5/P2NZbw8U5d+MkO455I8TRZVmvrXyctos3WnKWyge3xDdp9IPLFWO8dMBj/9VXOSogm4bjnrgFJzTGcFsPl9PNtrN4+QLw6FN34t7yAE+3ArfQ9M0ZCsnSn27ROav7qdLRUR143NSTbX7J1QQmPa/nkw9LVE7+mP0zBT6I8UWtwCkaYLZJLREvv4t2a/+c2pC000g6Cn7xRp9mq+z8eygsOwNOHgdYc6rghTzj2cJMldTlyLmC/keiU5TwX+B7qbGueymbuSyECLhzNAngOKpnZvAdPzLcvtibejw0ttLuSOB+CIGSBc6/MsXw6Z7gCUP6aWy3KNvDCQszg+amZip/ShbJ7BGx0JIgXIyOq2HeuIQOP3sMUfE1sQkoqG999C1ZFtP91P7YtfTTZscZ3uPUq24Y6oQwMCg/1uVhC5DGnxphQqxLk54ub+28iK8UXgBn82RROLV4NiAvzkUglLqgAno3TjIAT6P2zUz2MSGirdrCHW30tlAnDB+b80O/o/18Gt9coD46qxH+FE2P1Ld5HtUfmCez6UhOHWSkYq7FfftftRJEVoCrQrWNoDa67vP4uMT7ltNzQxc1EvFOUw5aCL+TQ4e7GCcFa692LzOTMBIHz9u/s8ND1XwFAwk3bwLUKZfrdV/df8//7TzSMQlUQAaUxFxpcbD+Rqt5qaoi8ygBhbvD/ienYbsJkfh7/MEDioVdeoStkT0byYzM/qj1Y9Y5du16/QDh32ZXaGxFGAG/yfBjPFrJ5CXOHsCyKcNP+ZABf6WArOiYdz0wcysKynl7RAxA8s/ZDJsBkZEtC09iGKWthTyzlnVdqldTNR4kczlwJwWUY97JBe2K68xk2RIMm3g/RoO/wEj4zu3tmd1PLzV2ZVjZ181hz0E9LF6tdSx4VakNBG7+8nAQgaV2s64JliY17OOK96bhmLYKHgzb/NttUjidAbjobUPCmy5B7aNHafhpoFk8WLlOQ9+XKzMhmC1yVfDr0gh5Gk4Tt2dcehT/kXrDoJqWHtvmGVCJgZKEV07sijR9CenSHhXtvRjbwUxnJdffKprSrHYkyPRpHF0J125xam61eTCNfxWIVAW6c3qnQ7oe6WAbx6JC3MVAOOr22/3KNWtw5Hvuz6ddWVeqA6mYbxTi2Liht1nsSvhIjSn0/6l/PwRxSH/6/H1K31SdwTp7S8ni0N3mZEGbjNAa8UHIKzpqCPntO71z1juhBjIHOuB+59QUvvCIzsJ5mu+X0fblrzH83g5mEXtmZBZ6ovzjujUbI3lTodv8XVITJW/6txRGyI+M8lFZ46Vs7m/YSzZQx69srvodBTHG0LKCBak7fxSPKT1MFkQ91VvG1GSilAxslZgd7X5IFP0rJlRfOYNE8+MswyCbgfev+h2bwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==';
    </script>
            <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideIn { from { transform: translateX(-100%); } to { transform: translateX(0); } }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
        @keyframes shimmer { 0% { background-position: -1000px 0; } 100% { background-position: 1000px 0; } }
        
        :root {
            --primary: #FDB913;
            --primary-dark: #E5A510;
            --secondary: #C8102E;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #1f2937;
            --gray: #6b7280;
            --light: #f3f4f6;
        }
        
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            animation: fadeIn 0.5s ease;
        }
        
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 280px;
            height: 100vh;
            background: linear-gradient(180deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 4px 0 20px rgba(0,0,0,0.15);
            animation: slideIn 0.4s ease;
        }
        
        .sidebar-header { 
            padding: 25px 20px; 
            border-bottom: 2px solid rgba(253, 185, 19, 0.2);
            background: rgba(253, 185, 19, 0.05);
        }
        
        .logo { 
            display: flex; 
            align-items: center; 
            gap: 15px;
            animation: pulse 2s infinite;
        }
        
        .logo-icon { 
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            box-shadow: 0 4px 15px rgba(253, 185, 19, 0.4);
            transition: all 0.3s ease;
        }
        
        .logo-icon:hover {
            transform: rotate(5deg) scale(1.1);
            box-shadow: 0 6px 25px rgba(253, 185, 19, 0.6);
        }
        
        .logo-text { 
            font-size: 1.6rem; 
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .user-profile {
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            transition: all 0.3s ease;
        }
        
        .user-profile:hover {
            background: rgba(253, 185, 19, 0.1);
        }
        
        .user-avatar {
            width: 55px;
            height: 55px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            box-shadow: 0 4px 15px rgba(253, 185, 19, 0.3);
            transition: all 0.3s ease;
        }
        
        .user-avatar:hover {
            transform: scale(1.1) rotate(5deg);
        }
        
        .user-name { font-weight: 600; font-size: 1.05rem; }
        .user-email { font-size: 0.85rem; opacity: 0.7; }
        
        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 20px;
            color: white;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .nav-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background: var(--primary);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }
        
        .nav-item:hover::before, .nav-item.active::before {
            transform: scaleY(1);
        }
        
        .nav-item:hover, .nav-item.active {
            background: rgba(253, 185, 19, 0.15);
            padding-left: 25px;
            color: var(--primary);
        }
        
        .nav-icon { 
            font-size: 1.3rem;
            transition: all 0.3s ease;
        }
        
        .nav-item:hover .nav-icon {
            transform: scale(1.2) rotate(5deg);
        }
        
        .main-content {
            margin-left: 280px;
            padding: 30px;
            min-height: 100vh;
        }
        
        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            animation: fadeIn 0.6s ease;
        }
        .page-title { font-size: 2rem; font-weight: bold; color: var(--dark); }
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: 0.3s;
        }
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(102,126,234,0.4); }
        .btn-success { background: var(--success); color: white; }
        .btn-danger { background: var(--danger); color: white; }
        .btn-edit { background: #3b82f6; color: white; padding: 6px 12px; border-radius: 6px; margin-right: 5px; border: none; cursor: pointer; }
        .btn-delete { background: #ef4444; color: white; padding: 6px 12px; border-radius: 6px; border: none; cursor: pointer; }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: white;
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            transition: 0.3s;
        }
        .stat-card:hover { transform: translateY(-4px); box-shadow: 0 4px 16px rgba(0,0,0,0.12); }
        .stat-label { font-size: 0.9rem; color: var(--gray); margin-bottom: 8px; }
        .stat-value { font-size: 2rem; font-weight: bold; }
        .stat-card.blue .stat-value { color: #3b82f6; }
        .stat-card.green .stat-value { color: var(--success); }
        .stat-card.red .stat-value { color: var(--danger); }
        .stat-card.orange .stat-value { color: var(--warning); }
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 20px;
        }
        .card-header {
            padding: 20px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .card-title { font-size: 1.2rem; font-weight: 600; color: var(--dark); }
        .card-body { padding: 20px; }
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }
        .form-group { display: flex; flex-direction: column; }
        .form-label { font-weight: 600; margin-bottom: 6px; color: var(--dark); }
        .form-input, .form-select {
            padding: 10px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 1rem;
        }
        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary);
        }
        .table-container { overflow-x: auto; }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        thead {
            background: var(--light);
        }
        th {
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: var(--dark);
        }
        td {
            padding: 12px;
            border-bottom: 1px solid #e5e7eb;
        }
        tr:hover { background: #f9fafb; }
        .custom-select-container {
            position: relative;
            width: 100%;
        }
        .custom-select-button {
            width: 100%;
            padding: 10px 35px 10px 10px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            background: white;
            text-align: left;
            cursor: pointer;
            font-size: 1rem;
            position: relative;
            user-select: none;
            -webkit-user-select: none;
            pointer-events: auto !important;
        }
        .custom-select-button:hover {
            border-color: #667eea;
            background: #f9fafb;
        }
        .custom-select-button:active {
            background: #f3f4f6;
        }
        .custom-select-button::after {
            content: '▼';
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.8rem;
            color: #6b7280;
            pointer-events: none;
        }
        .custom-select-button.open::after {
            content: '▲';
        }
        .custom-select-dropdown {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            margin-top: 4px;
            background: white;
            border: 2px solid #667eea;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 9999;
            max-height: 400px;
        }
        .custom-select-dropdown.show {
            display: block;
        }
        .custom-select-search {
            padding: 12px;
            border-bottom: 1px solid #e5e7eb;
            position: sticky;
            top: 0;
            background: white;
            z-index: 1;
        }
        .custom-select-search input {
            width: 100%;
            padding: 10px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 0.95rem;
        }
        .custom-select-search input:focus {
            outline: none;
            border-color: #667eea;
        }
        .custom-select-list {
            max-height: 300px;
            overflow-y: auto;
        }
        .custom-select-item {
            padding: 12px;
            cursor: pointer;
            border-bottom: 1px solid #f3f4f6;
        }
        .custom-select-item:hover {
            background: #f9fafb;
        }
        .custom-select-item.selected {
            background: #ede9fe;
            font-weight: 600;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .modal-title { font-size: 1.5rem; font-weight: bold; }
        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
        }
        .img-zoom {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            cursor: zoom-out;
            animation: fadeIn 0.2s;
        }
        .img-zoom img {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            border-radius: 8px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }
        @keyframes slideIn {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(400px); opacity: 0; }
        }
        .section { display: none; }
        .section.active { display: block; }
        .search-input {
            padding: 10px 15px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            width: 100%;
            margin-bottom: 15px;
        }
        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
        }
        .badge-success { background: #d1fae5; color: #065f46; }
        .badge-danger { background: #fee2e2; color: #991b1b; }
        .badge-warning { background: #fef3c7; color: #92400e; }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <!-- LOADER INITIAL -->
    <div id="initialLoader" style="display:flex;justify-content:center;align-items:center;min-height:100vh;background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
        <div style="text-align:center;">
            <img src="data:image/webp;base64,UklGRl4lAABXRUJQVlA4WAoAAAAgAAAAfwIAfwIASUNDUMgBAAAAAAHIAAAAAAQwAABtbnRyUkdCIFhZWiAH4AABAAEAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAACRyWFlaAAABFAAAABRnWFlaAAABKAAAABRiWFlaAAABPAAAABR3dHB0AAABUAAAABRyVFJDAAABZAAAAChnVFJDAAABZAAAAChiVFJDAAABZAAAAChjcHJ0AAABjAAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAAgAAAAcAHMAUgBHAEJYWVogAAAAAAAAb6IAADj1AAADkFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAACSgAAAPhAAAts9YWVogAAAAAAAA9tYAAQAAAADTLXBhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABtbHVjAAAAAAAAAAEAAAAMZW5VUwAAACAAAAAcAEcAbwBvAGcAbABlACAASQBuAGMALgAgADIAMAAxADZWUDggcCMAANDfAJ0BKoACgAI+USiSRiOkoaEkNJhIkAoJZ27hdY5kcAOFbfH1x8afS/mP7TVqfuP4Y/u/zcfyu6jsjy4PJ/1r/Zf4L8jfm9/xvWn+hv+r7i/6n/6r/Df5L9nfjW9eXmx/cT9zPbR6ST/udfB6Vnmm/9L9xPiX/ZD9nfad1PV7v+U/z/iz5g/bPth+7n2N4o/lvA/+cfeb9V/hf3E/Mn8Dfef4u8Aj8q/nv+X/sn7gfmdzHABfzj+2/8n0yvw/Q37R/8TztfYnxtKBX6K9IrU+9a/+z2Of7p/xBA1cOq27gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7f6jmkiXyCpza7gDm4ZfIKnNraVr7aF64O+wqjKvaiXtRL2ol7US60W/Pc3/UJR4dVt3AHNwy+QVOGn+uGgM7LoRy7SSBJmg7A7pOqyDLqRL5BU5tdwBzcMavZ171JbC34LVT74cBVSPuuZBhhbGgFsnDAmPcoWi/m5r/KqYje4dVt3AHNwy+QUV3Q7JXuCiUvdYPjYJNG1eZGBoLc8liN7fHoQ4K0siUzTR/HzIAh7R0c3DL5BU5tdwBzRT4espWY1N5oob2qcTl4jgC3+baBCP//BWKLKtu4A5uGXyCpza7gCyR4Tv9iffUhhoqNol/qKw1wiyWvGReluI/PEWIXrcoXDqtu4A5uGXyCpMp9wGSF75HqJxPj4Fe7c+v0Sa7zvUM2u4A5uGXyCpza7gDjA5UJO6k3itPmH2ERN/RWOXA3uw8sX9P/65bB8Jl0wHNwy+QVObXcAc3DVyufYnAIXhU9hGv6GUr9y76hl4ceR5VqkS+QVObXcAc3DL5BU7W0srr4JodkBn+QgtpJNrxboI3cAc3DL5BU5tdwBzcMxXxX2gHWlazWztuJ0hJ//8TMxBgBzcMvkFTm12/0MD3fNJGTI+Htdo8SrEhPVFfLCZ2tOVw6rbuAU9WdutJyiPUim00AplYFbMLV1KgPoY+ooRFXc1B820fUstEkL4OV7wnGhfTTfQH5xinWkBpgObhl7qZD0dP7EHXOOXoPafFIJDfiRAFD/eviFpnqjXRwjkYtFWi9c+VkQZUy6+85Diau+RWEEYTbIcrVi8XseW86krU+DhfQMtPKdlNYg+T+9priokvPl10DD8IX0GlBsPDeqVl0grzeA/VSBJ3AHNwy4KvDMEMjeTcFGTLLPJFy2KuzP58Uy8VkzxCddx6OlVtDI6jNS6feWQEXVkQejrJ+OEpS8h7hnVyBPqPKQsR+5kvOfrRZy4nS8oVRjuad6mz4k/7saX38sLNruAObhjekUqiPeu1PPU2lyp/rDGfZE5/PnWVMkyMdw/6xW/QtR/2u2JZKEKePdyZy6n9A/PfdEx1AMpO7v3pV/vycxmLff3/2fe5oQHmaT9dQpES0f/E/rqrlu+D3GP833W6H1xs3DL5BU8fkUhp5GqQSOJK75qVxbYAtv4oBlMH1brEZLb+3kszmh8DB5eN3nz1hcTTPxEbMsjBycMTd0N8i2cKjXMLwBP0MRqIaMrvsZHnHm8hFTTTX9XyXt+NXM8toq3QkS+QVOZqpHYBY5CoHNvp99DTxW3hRxJvUZwbZtZ2HC1wFxXS/SACvAvq/9b7YhxYdvXPwHUkyaM3VVvyWvfrU/fbPn2RcLn1HuAbWEJd2Z1GcnwP22AftnlQL+cr2pvJxz9e7VGcD05pIl8gUDKFNzSQdAnMO9x+9OG1crGg8MUCZNDLk9XkxRg4no4m+MXJSNrHRAgsEmTTatM4ANieVDrfEOWzrg9xLAYzaiIfxgHoaHctoIOyRUaNeRz8e44t9n9q3lamop9OrOwkmSrRv1V2kVPzQXBVrXrZhgYgR+66XuSgtR0MHzmergKOzCpQx2WrtSTeRL5BU5tALEyII2QyVMbIrwVfmurvUxCIQ8pQ/zAAbLUIy5DVn77NWA6CpVN/8AhfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqc2u4A5uGXyCpza7gDm4ZfIKnNruAObhl8gqcygAP7/xLAAAAAAAAAAAAAAAAHhgBEbys1Bjv5GTjFRkjfKaiafjQ3UjRwIwpTYRO4fQzB3pTE75RAOfolmT8NPj7aq2aB1XOaIGlThu16sEdj2rjiHQovaCoketM4kO9OyoYaIVWJOjp3qrh0et5XlS4Oejg5CBhiTjpatIpyGtyd0zfEgOgPVzwPXTmN4A410DeJ2NTIviPQVEUlOcFCi+pU2B/y8QsQkwLvMhNgEGmBP/PRKT39FoyTvq8Q6T4TR7SaK8u8x93LamRSfZCTVvUd37IBUrXASeXNWkZy++4uCHXIFB5NzBrCEXnapjh6KUJ2xGmSI9SXZT9dtRkwPhdSKG3IvtKVIEpJ4xwjIhaxIK1O+xuJBg5n0l24Il36KP/KXszRvDL+KhQHCUOQrLjEu6j4pOLH5A5xWf6pRdlkpwvZiYmliP2O0JNvBVWUp7WWJ1UJY6TkWtB4I0oA9vh6XiVH5A6uOKoNB0nClMxbnSjpY4C1bzhPJSRuD68G/iuxmjxXpz+DLV/SjwharFVRufM+oQwGzJTs4RG0yTFbgl+pBHmhoJGlUXBHtLAIvKrZqzzyY0L342U87Bv6ZWjxBaro6YLSGtfj4aSHZ9vOYAwpMZvunhSu5q4iGcbl8g0S+5RlQMptyAq64BFlCv8JhOq/WDqfyha3ZJC+g06YG3mBf/qedJPC6azG626evy8H7bxDPeo/SnqqQDActvSjr+310gzCIYhNIU3bN/w1BGTnSFRZZup+4Y1nD1yTdpMYfYSS0XQbq0Q0A6zn+WadP9Ap5AaS3yXBUYov6ZaGCnaBI25g20g5TJTZvU5OczEOsLfxeUXLTm8P/bhhJPRnI6YSCRieOcSf/32rFVlWgskGc88bPR13SQHQAtsiCqqcwkrwldZfXOFAx5iiqnKLCQVZ9W2ygq5wOHYipgNsMKip9ONJYYzJSsQTcLzfQSExesDhyGlKKBB9RvxYUU9rQ0zT+Y3S0M9aBLDGXG4T2dHeLCrLl/I2tVy1jdFz80jWY9Qb6cld5UhJSKQFQObv/lZqN1qcB3qBLuPa4/C+5m4rmqAsbYZa76M0erYiBJx2WgqjpLmNCBAAAOXLoQKI+Y7OeSkpaHz1ZoCkfUg94ScvgqTx1yWI7DaE5zbjOpdI14D4T6Bme+pjI9WkDk2tONMSM5S3hdqav1K3ov+a6vgxONOFKD85+JA1tML+0qeXq1UInetHYijGw9Zq35HwJoeXFlClIoBIAvaJ2TTlZiGO+NgslI+lsyKfpPuLZs0CnvgHVUtL7nH7l09+ceTJfWo97daDAD9+1QRrmp7Be7Vty9puDyrAM/B5UCxCmz6t6oKzH2a5Ybvc4Az24IIhQAAJXU7r88TZ1aQ6ekh16iEC8yT9UwLdNyQJvR4RzF6DzIJpR4akWHIRgPJMsvmhivY4IoTP1HhB/YmiHcGlGZb9Fb7mTm4PwfSYLYE+Ugkh699zhRGz9mft/+x10xYQHt9uzmY6PeR1leDf4mcr8F2baUXPb3prfx6rVzDHhJEUviOzEoPWCM1LRVttEPeygN34XaV0s0Xqji+peXieMPUoSXEUX4ceE7gKhSDPLeKfup6eorYm8o8P2ml7kh+mZbRsJV4DBoUnLSIdn44JPIDEoV7TgEVRqNjGZzpsKfwLsekvnbhKyvNPhaQW8zBajhWSBJUf0493UeMO0saU4cPnAhCPgZwT8AA2Jq5WEYQihroz1KJcB0NWfN/Ks4juMCB99JMJP1vhPNbSsEOBpC0taYkgJ0FYHZgh/z0glaSKg57rBo/3FnMWJj/hV7Rn5gAAuKe7pGRFNLw6A+dnKREjgYSCnBUbxBqXmPUI0TRTxjckAz/4sWJED690WoJN8TaL/O6AxeFnJsV2eMzaEc/SjtpXYpucDRCjOTrpCB+OOB03H2SEWSraOtnXQ+vL2RelotcBzOTpWRDj7X8mSGg3ROUG77neVMIgBPBZPThXHkI7q7eqGUacd5LvmoO11/uwqG2eNTqC6F5dmyOZbpCNDEwkz7Mg3OpofLu2je5HRnqNBmAAHzKQiNKAW+bxs3n56hB/2S9gifCbd5QbkffDG4shLbBsn2PdQVeTVcuTeknJeFwmTyI0+7r5FgpQmPATnoz7LsSno6JwGYAVUVFMyCeg+/hkqpefYI979Fa3Xw2riupPZWaipwdlBau9pLJZJ2S7fbs61/AigDCgA9UreGb0Md8F6PDy5I4Ak6Hv2pTSmta1Xo6EH06NzY6XP/W0C935OzM+eKej4tQnQLAvetIM2/vdHb9/ojqDaLpV96CmZE0QzAohIIEvpR87LRSEC0I7kuqFadAdnBcJR+WJIxWJEo3OD5lhl8t29ACRmAJ75SWxpHjFzABwNMQxKIDWhvOypKc7X9UnGGbbFOkQxokRTuUrm1GyGVZ99hZ2rOuIRmCRbtN6ThrdX4YtbjAFwS1ky3Lp79XKKRj/88Fz6lC0ParpgDfRwgkCkPW5huEL+FbZu4OECtWMdWJvqt4Qt8u+GB7O0enVnYCdSUVJsKRGPUXKB7oAAuE+Gcd/Iu12pI5jwwAAAAAK89b0ui+Pbycz5tG+32kbMajvTmbqRPSlphoCmrYP2W+E19Mg7ad6TMZ/m2w4EShXlyIDZG4Kf5YGwyM3c6PCpfWTZKzEI1Xkk0uVhgZYV+7KCgbi5/qrC3EvBUMSqEs7lcfZBjHDYXiGbTdFMrcA/3ZFHY3t4eJ9lFuPQvp1mC3AvUK2rjXDsABK5tSATqMBfWLkcIs6Q3kSp2xdAtnlm0eC4GA3137OVkuQLBUea2/hTSBCPQteUgiFEkefMPLioGjJeqO2c9iPhj/ZLix7rWSQpkLVHHH7zW+kFzz9r+slMXRqPg1H2jkrm8rI7haTRxuk2Z3vQvj8UHHJC7TrTs1rTH5WOzpPK5O5EiIHVnpsRzk1Ccr4vbkjTpV4F/1WUMPuWfS+4XS+aukqrGKUsUsuBTynGxfF8lF52aTZ2nyJJRUp+FlMUlWS5DxatkeCxD8k3YKMz8RZOMmvGRyVgAeBR4EMQ98oMfWZUeBiII3SZ+oGSCY0zdpBU7CRdX7wrHckPLyhnoq7Wdo8OPEMnBucMuL5eIJwc3UhkVh4+klRtQeewQegdGPXBX37bw+N+bzfjoYKKcd5oCQEa5PHdoUn8x+vhkvCwFlm1ZncqE/jSIv7/qgHzhzROssgLx1fm49snyqTEbtclES/06ZSIuLJiw+hv/2IgUxvptjnXJczbwEhh+t75jSiOrbfzgNpJHCSJMSvhofc82tsqPd46qI8bC3zUz6Dn8N2BxKcLEcwGgcEiWmin2zkmMJojs2LjZlv9H3bbYZYTA/bP/enRTaoN3vLv/3D247kaRBsKCgnYrNto+lIN1hrL8lsd0k2EAjxb9uBPtQ7TWkklAtlKmvum5YeFRubmi3dMg2iYBFid/rgznC4fgnli1fIFUrg+N370YSTFx8v46XMT1GB8og21qmsBstfZh+euStOdLhOgmQoPlxpFgZ5teJmUYa/apM6l4563UKULJNTsQod71+TL1ekvH8OJvXV+HquKiYKhaZ+wiVc7gCf/kaPBADn7e+fMUfNpkE+kBUWrlnpbaLwKJmHe7kiGf/L7FIRq0wGk/NVJjFkkXyI0yD7rTf2Awsq/mhwhGCAE7GVQuREXdOP8yByOkbxutUeS18Aafq8AtsSjmjVp5qyR9dzE9xLzXlmesSTciywNtmabp13i6h6k063oiMtprkrZQvwBaA1GMnHjgEZvDMJSkRtSCdvPBM95wwSdqNxFsQf364QzuowokwtvrJmNVL5OUTLCdVCn0wd+f3E4vc74bVA+Gnv7890ZftT78oYXOMy1I66fZVOTCYxfQoprazGfbQAElvMrtLQ2CPea8YTfS1w8c/7+FdwNSdPJtkyNGb29Q5q23O0Z1z6B80afzEe6Zbn5XK7q8X6ljpc21wo1VQ2a5X9E+D8+ZnMdfW8bzRzXXarBX+F+79AZxs56rFa9uH1JeHErvn3hcBotOq7MrbxWmVHOo0+XTq8+K4YWgZpcmIIxBeb/BE5vlFFepaPdEA/y5mGTUmAF1qoOv7hQCQLqsB3U3yb6pdpFgcrjMEdSNexNh/HIYRa1wjlLtGAbDwrnVXABwRoFBiD/bUg0ybgtpa1ByutwtrmmICyTBYGJyUSJ0eFSg5Ku3+9vUpFNz7YV4mFqZX3SEyZv1OnxNBZQR5UuY64/Gh6evVPx3Blnw9kf1Oi/SESIb9vUNQ5UfyZHelZbcdqRuAb6bR4bdw2OLe2AdCKDcvp5ic6M+MoI2/ID9e58AjHXY4NgiA5vnJ7Cto8aVJEns49yvpxkWw5FIn5T75mbExGmmw0QHSlwDzksZ7ydKepTpYHsMkFnKeY5N3qVh6TczWl01DoI+4Jvs1499W1VvPAZ1EBuxEBGWys7HhbvCumPbwxAqD/ufDYLBXeUeN8/NvfPmKVtppkQPwKcfF/kLN3/R1ZNVxeQEbr6wyjqCI1yh9slGw4wqaEtLhcGUA7Sa5+PrNQUxnK26o7oS8rJcjZZZ0s1gzKb//Za7NrIYD8WutkUrPORK3Ab3KBB+JRwymg1I+i4hzt8UcuiHC6LhaHUwkqkqa6Geq2du8MmmtXyTtGaNjSR0NJkhq/HYSEIhDCmIGm06FkeUh1KFXkPDH5GqWWzPTnXkrllm7rg5VreGzPvMXNBvSqoaZqyvDVIL7A0E3uu3inbPAIXM7Jp5g1nWm30Gql8QfHkAC0dWIkqUNVF2IdNuIcLFmbmXw9C9VrFqXYvpTpwCcLz850DjpVIFPUkKqZmXLwXXqNcyovVZCcpu4z/k4qDtdYXNC9Pvypr8M1U7R1GPU5HK4HiJXVxbPQ4B89Q9ZQLEzt5VmWicZ4rhfAb8LbH25qqGY8RpG0U1X4z/7CnOqBoX4wl/nBxSomLqb9Y5gWtldtrbWy7TH8grMza9q9S+eCy8xFDtBSk62Ga5EII2cTApzhclQDZsX0Lq3x0/NvTaTzF1KxZEtQ9OZrJApZ1vXY6kBKEGRj7/MLy3jZeMZUhxrQ+ovnzHILhiLwy9D5O8If5n16LPgDnQ1v2ICRvVuPzd9Z7eAHh6kb2ogetGjggsunBpUA0VepebtQlVIFGnraGX+kBJP3qfa1zw/YmtO4WtVxX9THfT6t7Las8e0pWu5OgVGmEFNh+1PihPLeWmHM0KR9DgyakOvfKk4cojMVUh16PXp6p82dke7UNzjaHSIOSUklfhr8Ofe6Afo8+pDNLIELS05+9k8ut/NL4gEg6twbndQawycoaMlBfz10AZMjyZyJZ6NFr0311LtJoq4hOpPgcmjpKifYENDr9fyGf/l73P/FnWJVTNoaVxIPlORyuESn5cbQ63ul9bMhGR3a0bV2Iq1W3eqcTw9yofYHHnxEBH3q9qhvK5kTps6Y3bh+WwfZN09gjXWgbp2DguBGgIeFG68eiZ2C/NrQfuM+9/bGsXecrq7T1SSWImcYx2/tcee4rJ3AYoqjJ/t6bqhqJimZW+hMV7zdnQnrX8lkZOjJMtaKG6wXbXmtnMlizPtIe52XiLkGjJFKaJBC5wMHpm2Zwv+VGyRsmmGfQb/hJjxeDhqYrTdpcZ66XOr4APcmbE2UFtzXZHOAyaD7raKId1MrAZnDWtYbKGSSM04UilIKuRot+tKPMiULOrH7c1j3gCeK30+pR2WCEb9+RAy5Rh5rUAz+xapbVyXoBMt4iCgL5UmI/8wpcA0jI3Mq2fUsVQstoJvbaarzYsN5bvCD/E3r3nlTsrYjJRi/g/Coh/D5LOUwvGUUk43ocH475yt3rt7rsRKgFbrR7NOZqypr+AgXBreUDl5ImGooS4uAHHVejICs3fzUPeOVsWU8PV2A9NSx3bF41qVkfH5TEv0US6LaRJ1T6zVnByIQ+YHnGU8IoBNbY6ISTRmX4Ui+J3CI4S3Jey0cHed7tV1/yXAap7HuRGjNBN7NSDnfiWz+wWVCHgAU6LE1zDV24AmO4yYRf1oJL2DuZcwwa+WGSGvOg4LQDK/psDocX8VetFFhIoYAx6fMJnI+cbRqkyBBDlznxuAVplZTqxeJzWIq6RJb7Ofmp4DDzjO26yeBOsAtMCwrWJkUPW5CKEOeJ1nxXlsRpGL6BiVZOXOfIh5dw4/i4nPCFO5/sChsiLPTvfRLRinjnKxiWH/PJj9hKgiwixQ3fDQzLD8zdYQwO6aj858HUL5N9+oRizGj0N9HYdnHuAHwq5mJOYprQR8P7lYc3MaAfGvxJeJ254V5VjxVHTX1mIy0TsTtodiRVDgh/T0QemIdKV7CNAIueGgdJfva8TudUx0gqDiGDoESsRY3Moqt3Nv5ca7CQktYd8kVe3XhQq0G3ZfeIEK1gHcgf28PVM3VHjoc8TbCI102IhvPlluRY32O6wGJp5+pzgldnGgThC8aCY4PncfjXhX615PSm+sRmwHh9KJdQlyO45nlTX/Bx82WW2mz/C/3HaPH4vy9oQlYEJK9NnwkMicAOJFmAIT0BAVWCHp2ZECorW15cDPh18SEvEUz5nmHREoM2GTCUknju67JzR7Rvobj0/4IBXHsvCK6gpYzQKHYXQvQAxEKvw/UpSNLcTusvShDcxmHq7UtJUzA491qkFEBLArjJLFJ3EMRpRpytKxpRL9h2xPWaj2k75Bb5g/55dk7uZRA4tPR53W96VTL5mDXuWxPrmMWWdV3s2I0AO53e2j0KsnkbLywyjGhbyLzHhr71KNjDKu8Y1556XhzPKJYISmESkyd6eVUKsAGNBPj5pX17mSujMkNvkghiCdwbTncbpCRFl8Ob80UYKcB4YOWK6Nb48f1EmYahNK+w8bgB2M1t91h8eXiNKqOxdNlmQx5cl+/g+j6RTJCDEDnLWCzc+2Y6aOjKIgZg6s/1eMKXf0LwojLENimpVCnGWMMc5yO+cRVdwT9ryhr/fY0vyEu7vKEj9EWfdDSX3ENOHeKEmwtdTbyHDREUrak0gUByzZTgg4IVFTQd+nuH4+1eLcIHQQ3/iR9wnf/zbShWSNVjnhqtoRDfqQZZnLzPFqdoVToc5RiDzguK5SAqSNHcquJG0JabCP3g8nAiBR7D/jB2ts9y2/Othtm1EvSoUDUJM6XV1zo43kPOzPLkyTt+SEU9hF2iSEggQKWkKU6Bnveoqq187rlzhzB1v8r++9vW6jbYgv+4tm9JJZZUi/ta8RTVSUvV8HS6lr/hjkp3a9NvzT+3ezIq5odW85mRLyCl0TfbqkLDPhm7fmdu8w/Z0wmCgZL1CWCAq/w8V3FqbOSwYThw4rGDwnkbO0kNYireh4T/+beo23rya9GX35UVH5NMySwUe6DmndOsuMCH0YYmQjXt4bBMSg4p7tcy1LT3ivXAsZiRSLFVwsBcerE5IUL4NFQlaj/m3l3uLzPPNSfbYhekzKpnxVLk25y2Bsg//DAGulq2ejjfe3/o69sh9GClP/gzAduu0L4sLUSRV/INlFvyluR0JeTr1lB4DanEVsMSAfQO6q1yo/cWUx9oOEQrLeFF9ldTg45s/xSNqw9xLCgavS/+eD3TLhYaiy94TUylr/CSr5BAsXQmMgsXe20mxP9ffIbgud//sC96aoK2zaA7O2w6Hcidaf1f9no2v4Uvs0TftjPN9cAGA92gzqs5YvpOg8K/a52Zngw5YECq/wgy+rDv2MN0d+qbNpQRASTxT/6ihaUYmaHrSwvm+Ec1fcDhfFX4mxfD2JGj+SwT70Cqz5bGqCIk/8ptAlxw9HLIm1qBle4r/7IKgA8b+lBaf+0xq4k2QHMDNHKpKsygpwARpt6+/ll5kV6NmLXsB0i3uAWTO7cAsgszDjsKm4865SkabLPiL6u74vefhQ82Ug5obvv1Z+hHKDhRaSu9g8jvsqD1qATdnRTZLWT2y6r0lGAa4wwW8SHzN75CQU3Y3u0yIF7cAwskyKIU79S08rfhnmOR+nCyIOg8362lr151uqPJ20jDBBsgJlcfr1kViVtb8kPKSOxevKAWwmtcq2BjiKYcBtFaaQT/Ne43ipV7g1JvNEqGORrf44u0w35/oH/f/hgUk2GBtjXDKE3wcc6+/FzcE6fvHFecFnl8SmVLBcBuDEGl/VHNcQoWgKTjyKELnj0UJXwqIWqj6jG+rTn828pD22F58zM5+zh0iN86nTpEF1no2NMYht9F9VbLgcXYXySKraSjUoXIyxGe4glTgtdqLssqNQPyocws5/P2NZbw8U5d+MkO455I8TRZVmvrXyctos3WnKWyge3xDdp9IPLFWO8dMBj/9VXOSogm4bjnrgFJzTGcFsPl9PNtrN4+QLw6FN34t7yAE+3ArfQ9M0ZCsnSn27ROav7qdLRUR143NSTbX7J1QQmPa/nkw9LVE7+mP0zBT6I8UWtwCkaYLZJLREvv4t2a/+c2pC000g6Cn7xRp9mq+z8eygsOwNOHgdYc6rghTzj2cJMldTlyLmC/keiU5TwX+B7qbGueymbuSyECLhzNAngOKpnZvAdPzLcvtibejw0ttLuSOB+CIGSBc6/MsXw6Z7gCUP6aWy3KNvDCQszg+amZip/ShbJ7BGx0JIgXIyOq2HeuIQOP3sMUfE1sQkoqG999C1ZFtP91P7YtfTTZscZ3uPUq24Y6oQwMCg/1uVhC5DGnxphQqxLk54ub+28iK8UXgBn82RROLV4NiAvzkUglLqgAno3TjIAT6P2zUz2MSGirdrCHW30tlAnDB+b80O/o/18Gt9coD46qxH+FE2P1Ld5HtUfmCez6UhOHWSkYq7FfftftRJEVoCrQrWNoDa67vP4uMT7ltNzQxc1EvFOUw5aCL+TQ4e7GCcFa692LzOTMBIHz9u/s8ND1XwFAwk3bwLUKZfrdV/df8//7TzSMQlUQAaUxFxpcbD+Rqt5qaoi8ygBhbvD/ienYbsJkfh7/MEDioVdeoStkT0byYzM/qj1Y9Y5du16/QDh32ZXaGxFGAG/yfBjPFrJ5CXOHsCyKcNP+ZABf6WArOiYdz0wcysKynl7RAxA8s/ZDJsBkZEtC09iGKWthTyzlnVdqldTNR4kczlwJwWUY97JBe2K68xk2RIMm3g/RoO/wEj4zu3tmd1PLzV2ZVjZ181hz0E9LF6tdSx4VakNBG7+8nAQgaV2s64JliY17OOK96bhmLYKHgzb/NttUjidAbjobUPCmy5B7aNHafhpoFk8WLlOQ9+XKzMhmC1yVfDr0gh5Gk4Tt2dcehT/kXrDoJqWHtvmGVCJgZKEV07sijR9CenSHhXtvRjbwUxnJdffKprSrHYkyPRpHF0J125xam61eTCNfxWIVAW6c3qnQ7oe6WAbx6JC3MVAOOr22/3KNWtw5Hvuz6ddWVeqA6mYbxTi2Liht1nsSvhIjSn0/6l/PwRxSH/6/H1K31SdwTp7S8ni0N3mZEGbjNAa8UHIKzpqCPntO71z1juhBjIHOuB+59QUvvCIzsJ5mu+X0fblrzH83g5mEXtmZBZ6ovzjujUbI3lTodv8XVITJW/6txRGyI+M8lFZ46Vs7m/YSzZQx69srvodBTHG0LKCBak7fxSPKT1MFkQ91VvG1GSilAxslZgd7X5IFP0rJlRfOYNE8+MswyCbgfev+h2bwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==" style="width:100px;height:100px;animation:bounce 1s infinite;" alt="EcomLik Logo">
            <h2 style="color:white;margin:0;font-size:1.5rem;">Chargement...</h2>
        </div>
    </div>

    <!-- PAGE DE CONNEXION - USERNAME ET PASSWORD UNIQUEMENT -->
    <div id="loginPage" style="display:none;justify-content:center;align-items:center;min-height:100vh;background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
        <div style="background:white;padding:40px;border-radius:16px;box-shadow:0 20px 60px rgba(0,0,0,0.3);width:400px;max-width:90%;">
            <div style="text-align:center;margin-bottom:30px;">
                <img src="data:image/webp;base64,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" style="width:120px;height:120px;margin:0 auto 20px;display:block;object-fit:contain;" alt="EcomLik Logo">
                <h1 style="font-size:2rem;color:#1f2937;margin:0;">EcomLik Stock</h1>
                <p style="color:#6b7280;margin-top:10px;">Connexion</p>
            </div>
            <form onsubmit="doLogin(); return false;">
                <div style="margin-bottom:20px;">
                    <label style="display:block;font-weight:600;margin-bottom:8px;color:#1f2937;">Nom d'utilisateur</label>
                    <input type="text" id="login-username" required 
                           style="width:100%;padding:12px;border:2px solid #e5e7eb;border-radius:8px;font-size:1rem;transition:border-color 0.3s;"
                           placeholder="Entrez votre username"
                           autocomplete="username"
                           onfocus="this.style.borderColor='#667eea'" 
                           onblur="this.style.borderColor='#e5e7eb'">
                </div>
                <div style="margin-bottom:25px;">
                    <label style="display:block;font-weight:600;margin-bottom:8px;color:#1f2937;">Mot de passe</label>
                    <input type="password" id="login-password" required 
                           style="width:100%;padding:12px;border:2px solid #e5e7eb;border-radius:8px;font-size:1rem;transition:border-color 0.3s;"
                           placeholder="Entrez votre mot de passe"
                           autocomplete="current-password"
                           onfocus="this.style.borderColor='#667eea'" 
                           onblur="this.style.borderColor='#e5e7eb'">
                </div>
                <button type="submit" 
                        style="width:100%;padding:14px;background:linear-gradient(135deg, #667eea, #764ba2);color:white;border:none;border-radius:8px;font-size:1.1rem;font-weight:600;cursor:pointer;transition:all 0.3s;"
                        onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 8px 20px rgba(102,126,234,0.4)'"
                        onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none'">
                    🔓 Se connecter
                </button>
                <div id="login-error" style="display:none;background:#fee2e2;color:#991b1b;padding:12px;border-radius:8px;margin-top:15px;font-size:0.9rem;"></div>
            </form>
            <div style="margin-top:25px;padding-top:20px;border-top:1px solid #e5e7eb;text-align:center;">
                <p style="color:#9ca3af;font-size:0.85rem;margin:0;">
                    🔒 Application privée - Accès réservé
                </p>
            </div>
        </div>
    </div>

    <!-- APPLICATION PRINCIPALE -->
    <div id="mainApp" style="display:none;">
    <div class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <div class="logo-icon"><img src="data:image/webp;base64,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" style="width:100%;height:100%;object-fit:contain;" alt="EcomLik"></div>
                <div class="logo-text">EcomLik Stock</div>
            </div>
        </div>
        <div class="user-profile">
            <div class="user-avatar">👤</div>
            <div>
                <div class="user-name" id="user-name">Utilisateur</div>
                <div class="user-email" id="user-email">user@example.com</div>
            </div>
        </div>
        <nav>
            <div class="nav-item active" onclick="showSection('dashboard')">
                <span class="nav-icon">📊</span>
                <span>Dashboard</span>
            </div>
            <div class="nav-item" onclick="showSection('products')">
                <span class="nav-icon">📦</span>
                <span>Produits</span>
            </div>
            <div class="nav-item" onclick="showSection('movements')">
                <span class="nav-icon">🔄</span>
                <span>Mouvements</span>
            </div>
            <div class="nav-item" onclick="showSection('transfer')">
                <span class="nav-icon">🚚</span>
                <span>Transferts</span>
            </div>
            <div class="nav-item" onclick="showSection('pdv')">
                <span class="nav-icon">🏪</span>
                <span>Points de Vente</span>
            </div>
            <div class="nav-item" onclick="showSection('history')">
                <span class="nav-icon">📜</span>
                <span>Historique</span>
            </div>
            <div class="nav-item" onclick="showSection('bestsellers')">
                <span class="nav-icon">🏆</span>
                <span>Plus Vendus</span>
            </div>
            <div class="nav-item" onclick="logout()">
                <span class="nav-icon">🚪</span>
                <span>Déconnexion</span>
            </div>
        </nav>
    </div>

    <div class="main-content">
        <!-- DASHBOARD -->
        <div id="dashboard" class="section active">
            <div class="top-bar">
                <h1 class="page-title">📊 Dashboard</h1>
            </div>
            <div id="dash-content"></div>
        </div>

        <!-- PRODUITS -->
        <div id="products" class="section">
            <div class="top-bar">
                <h1 class="page-title">📦 Gestion des Produits</h1>
                <div>
                    <button class="btn btn-success" onclick="openModal('productModal')">➕ Nouveau Produit</button>
                    <button class="btn btn-primary" onclick="document.getElementById('importFile').click()">📥 Importer Excel</button>
                    <button class="btn btn-primary" onclick="exportToExcel()">📤 Exporter Excel</button>
                </div>
            </div>
            <input type="file" id="importFile" accept=".xlsx,.xls" style="display:none;" onchange="handleImport(event)">
            <div class="card">
                <div class="card-body">
                    <div style="display:flex;gap:10px;margin-bottom:15px;align-items:center;">
                        <input type="text" id="prod-search" class="search-input" placeholder="🔍 Rechercher par nom, référence, barcode..." style="flex:1;">
                        <button class="btn btn-primary" onclick="selectAllProducts()" style="white-space:nowrap;">☑️ Tout sélectionner</button>
                        <button class="btn" onclick="deleteSelectedProducts()" style="background:#ef4444;white-space:nowrap;">🗑️ Supprimer sélection</button>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th style="width:40px;"><input type="checkbox" id="select-all-checkbox" onchange="toggleAllProducts(this.checked)"></th>
                                    <th>Image</th>
                                    <th>Nom</th>
                                    <th>Référence</th>
                                    <th>Barcode</th>
                                    <th>Stock Total</th>
                                    <th>Répétition</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="prod-body"></tbody>
                        </table>
                    </div>
                    <div id="products-pagination"></div>
                </div>
            </div>
        </div>

        <!-- MOUVEMENTS -->
        <div id="movements" class="section">
            <div class="top-bar">
                <h1 class="page-title">🔄 Gestion des Mouvements</h1>
            </div>
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Nouveau Mouvement</h3>
                </div>
                <div class="card-body">
                    <form onsubmit="addMovement(event)">
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Type *</label>
                                <select id="mov-type" class="form-select" required onchange="toggleMovementType()">
                                    <option value="">Sélectionner...</option>
                                    <option value="in">Entrée (+)</option>
                                    <option value="out">Sortie (-)</option>
                                </select>
                            </div>
                            
                            <!-- POUR ENTRÉE: Sélection produit existant OU nouveau -->
                            <div class="form-group" id="mov-entry-product-group" style="display:none;">
                                <label class="form-label">Produit / Référence *</label>
                                <div class="custom-select-container">
                                    <div class="custom-select-button" id="mov-entry-select-btn" onclick="toggleMovEntryDropdown(event)">
                                        Sélectionner ou créer un produit...
                                    </div>
                                    <div class="custom-select-dropdown" id="mov-entry-dropdown">
                                        <div class="custom-select-search">
                                            <input type="text" id="mov-entry-search-input" placeholder="🔍 Rechercher..." oninput="filterMovEntryList()" onclick="event.stopPropagation()">
                                        </div>
                                        <div class="custom-select-list" id="mov-entry-product-list"></div>
                                    </div>
                                    <input type="hidden" id="mov-entry-product">
                                </div>
                            </div>
                            
                            <!-- POUR NOUVEAU PRODUIT: Champs Référence + Nom -->
                            <div class="form-group" id="mov-new-reference-group" style="display:none;">
                                <label class="form-label">Référence *</label>
                                <input type="text" id="mov-new-reference" class="form-input" placeholder="Ex: REF-001">
                            </div>
                            
                            <div class="form-group" id="mov-new-name-group" style="display:none;">
                                <label class="form-label">Nom du produit *</label>
                                <input type="text" id="mov-new-name" class="form-input" placeholder="Ex: Coca Cola 1L">
                            </div>
                            
                            <!-- POUR SORTIE: Sélecteur produit -->
                            <div class="form-group" id="mov-product-group" style="display:none;">
                                <label class="form-label">Produit *</label>
                                <div class="custom-select-container">
                                    <div class="custom-select-button" id="mov-select-btn" onclick="toggleMovDropdown(event)">
                                        Sélectionner un produit...
                                    </div>
                                    <div class="custom-select-dropdown" id="mov-dropdown">
                                        <div class="custom-select-search">
                                            <input type="text" id="mov-search-input" placeholder="🔍 Rechercher..." oninput="filterMovList()" onclick="event.stopPropagation()">
                                        </div>
                                        <div class="custom-select-list" id="mov-product-list"></div>
                                    </div>
                                    <input type="hidden" id="mov-product">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Point de Vente *</label>
                                <select id="mov-pdv" class="form-select" required>
                                    <option value="">Sélectionner...</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Quantité *</label>
                                <input type="number" id="mov-quantity" class="form-input" min="1" required>
                            </div>
                            
                            <!-- Mode de paiement - SEULEMENT pour SORTIE -->
                            <div class="form-group" id="mov-payment-group" style="display:none;">
                                <label class="form-label">Mode de Paiement *</label>
                                <select id="mov-payment" class="form-select">
                                    <option value="">Sélectionner...</option>
                                    <option value="Espèce">Espèce</option>
                                    <option value="Virement">Virement</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Raison</label>
                                <input type="text" id="mov-reason" class="form-input" placeholder="Facultatif">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Note</label>
                            <input type="text" id="mov-note" class="form-input" placeholder="Facultatif">
                        </div>
                        <button type="submit" class="btn btn-primary" style="margin-top:15px;">✅ Enregistrer</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- TRANSFERTS -->
        <div id="transfer" class="section">
            <div class="top-bar">
                <h1 class="page-title">🚚 Transferts entre PDV</h1>
            </div>
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Nouveau Transfert</h3>
                </div>
                <div class="card-body">
                    <form onsubmit="addTransfer(event)">
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Produit *</label>
                                <div class="custom-select-container">
                                    <div class="custom-select-button" id="trans-select-btn" onclick="toggleTransDropdown(event)">
                                        Sélectionner un produit...
                                    </div>
                                    <div class="custom-select-dropdown" id="trans-dropdown">
                                        <div class="custom-select-search">
                                            <input type="text" id="trans-search-input" placeholder="🔍 Rechercher..." oninput="filterTransList()" onclick="event.stopPropagation()">
                                        </div>
                                        <div class="custom-select-list" id="trans-product-list"></div>
                                    </div>
                                    <input type="hidden" id="trans-product" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">De (Source) *</label>
                                <select id="trans-from" class="form-select" required>
                                    <option value="">Sélectionner...</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Vers (Destination) *</label>
                                <select id="trans-to" class="form-select" required>
                                    <option value="">Sélectionner...</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Quantité *</label>
                                <input type="number" id="trans-quantity" class="form-input" min="1" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Note</label>
                            <input type="text" id="trans-note" class="form-input" placeholder="Facultatif">
                        </div>
                        <button type="submit" class="btn btn-primary" style="margin-top:15px;">🚚 Transférer</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- POINTS DE VENTE -->
        <div id="pdv" class="section">
            <div class="top-bar">
                <h1 class="page-title">🏪 Points de Vente</h1>
                <button class="btn btn-success" onclick="openModal('pdvModal')">➕ Nouveau PDV</button>
            </div>
            
            <div class="card">
                <div class="card-body">
                    <input type="text" id="pdv-search" class="search-input" placeholder="🔍 Rechercher un produit par nom ou référence..." oninput="currentPage.pdv = 1; renderPdv()">
                    
                    <div class="table-container">
                        <table>
                            <thead id="pdv-table-header">
                                <tr>
                                    <th>Produit</th>
                                    <th>Référence</th>
                                    <th>QTY Total</th>
                                </tr>
                            </thead>
                            <tbody id="pdv-products-table"></tbody>
                        </table>
                    </div>
                    <div id="pdv-pagination"></div>
                </div>
            </div>
        </div>

        <!-- HISTORIQUE -->
        <div id="history" class="section">
            <div class="top-bar">
                <h1 class="page-title">📜 Historique des Mouvements</h1>
            </div>
            <div class="card">
                <div class="card-body">
                    <div class="form-grid">
                        <input type="text" id="hs" class="form-input" placeholder="🔍 Rechercher...">
                        <select id="ht" class="form-select">
                            <option value="">Tous les types</option>
                            <option value="Entrée">📥 Entrée</option>
                            <option value="Sortie">📤 Sortie</option>
                            <option value="Transfert">🚚 Transfert</option>
                        </select>
                        <input type="date" id="hd" class="form-input" placeholder="Date">
                        <select id="hm" class="form-select">
                            <option value="">Tous les mois</option>
                            <option value="0">Janvier</option>
                            <option value="1">Février</option>
                            <option value="2">Mars</option>
                            <option value="3">Avril</option>
                            <option value="4">Mai</option>
                            <option value="5">Juin</option>
                            <option value="6">Juillet</option>
                            <option value="7">Août</option>
                            <option value="8">Septembre</option>
                            <option value="9">Octobre</option>
                            <option value="10">Novembre</option>
                            <option value="11">Décembre</option>
                        </select>
                        <select id="hy" class="form-select">
                            <option value="">Toutes les années</option>
                        </select>
                        <button class="btn btn-primary" onclick="rstHist()">🔄 Réinitialiser</button>
                    </div>
                    <div class="table-container" style="margin-top:20px;">
                        <table>
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Type</th>
                                    <th>Raison</th>
                                    <th>Photo</th>
                                    <th>Produit</th>
                                    <th>Quantité</th>
                                    <th>PDV/Paiement</th>
                                    <th>Note</th>
                                </tr>
                            </thead>
                            <tbody id="hist-body"></tbody>
                        </table>
                    </div>
                    <div id="history-pagination"></div>
                </div>
            </div>
        </div>
        
        <!-- PRODUITS LES PLUS VENDUS -->
        <div id="bestsellers" class="section">
            <div class="top-bar">
                <h1 class="page-title">🏆 Produits les Plus Vendus</h1>
            </div>
            <div class="card">
                <div class="card-body">
                    <input type="text" id="bestsellers-search" class="search-input" placeholder="🔍 Rechercher..." style="width:100%;margin-bottom:20px;">
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Rang</th>
                                    <th>Photo</th>
                                    <th>Produit</th>
                                    <th>Référence</th>
                                    <th>Total Vendu</th>
                                    <th>Stock Restant</th>
                                </tr>
                            </thead>
                            <tbody id="bestsellers-body"></tbody>
                        </table>
                    </div>
                    <div id="bestsellers-pagination"></div>
                </div>
            </div>
        </div>
    </div>
    </div>
    <!-- FIN APPLICATION PRINCIPALE -->

    <!-- MODALS -->
    <!-- MODAL PRODUIT -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Ajouter un Produit</h2>
                <button class="close-btn" onclick="closeModal('productModal')">✖</button>
            </div>
            <form onsubmit="saveProduct(event)">
                <input type="hidden" id="edit-id">
                <div class="form-group">
                    <label class="form-label">Nom du Produit *</label>
                    <input type="text" id="p-name" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Référence *</label>
                    <input type="text" id="p-ref" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Quantité Initiale</label>
                    <input type="number" id="p-qty" class="form-input" min="0" value="0">
                </div>
                <div class="form-group">
                    <label class="form-label">Répétition</label>
                    <input type="text" id="p-rep" class="form-input">
                </div>
                <div class="form-group">
                    <label class="form-label">Code-barres</label>
                    <input type="text" id="p-barcode" class="form-input">
                </div>
                <div class="form-group">
                    <label class="form-label">Catégorie</label>
                    <input type="text" id="p-category" class="form-input">
                </div>
                <div class="form-group">
                    <label class="form-label">Marque</label>
                    <input type="text" id="p-brand" class="form-input">
                </div>
                <div class="form-group">
                    <label class="form-label">URL Image Google Drive</label>
                    <input type="url" id="p-img" class="form-input" placeholder="https://drive.google.com/uc?export=view&id=...">
                </div>
                <button type="submit" class="btn btn-primary" style="margin-top:15px;">💾 Enregistrer</button>
            </form>
        </div>
    </div>

    <!-- MODAL PDV -->
    <div id="pdvModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Ajouter un Point de Vente</h2>
                <button class="close-btn" onclick="closeModal('pdvModal')">✖</button>
            </div>
            <form onsubmit="savePdv(event)">
                <input type="hidden" id="pdv-edit-id">
                <div class="form-group">
                    <label class="form-label">Nom du PDV *</label>
                    <input type="text" id="pdv-name" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Emplacement</label>
                    <input type="text" id="pdv-location" class="form-input">
                </div>
                <button type="submit" class="btn btn-primary" style="margin-top:15px;">💾 Enregistrer</button>
            </form>
        </div>
    </div>

    <script>
        // ========== CONFIGURATION SUPABASE ==========
        let supabaseClient = null;
        let currentSupabaseUser = null;
        let useSupabase = false;
        
        // Initialiser Supabase si disponible
        if (typeof supabase !== 'undefined') {
            try {
                const SUPABASE_URL = 'https://djnaayhhntopupixzitm.supabase.co';
                const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRqbmFheWhobnRvcHVwaXh6aXRtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA5NzY0NTIsImV4cCI6MjA3NjU1MjQ1Mn0.AzrxJ7h7SNEgn-i8qgdGYPvoEpWdRohX1E8N_Ko_Gc0';
                
                const { createClient } = supabase;
                supabaseClient = createClient(SUPABASE_URL, SUPABASE_KEY);
                console.log('✅ Supabase initialisé');
                
                // DÉSACTIVER l'auto-reconnexion Supabase Auth
                // On utilise uniquement la table 'users' pour l'authentification
                // Toujours afficher la page de connexion
                document.getElementById('initialLoader').style.display = 'none';
                document.getElementById('loginPage').style.display = 'flex';
                console.log('✅ Supabase initialisé - Mode table users uniquement');
            } catch (error) {
                console.error('Erreur init Supabase:', error);
                // En cas d'erreur, afficher quand même la page de connexion
                document.getElementById('initialLoader').style.display = 'none';
                document.getElementById('loginPage').style.display = 'flex';
            }
        } else {
            // Supabase non disponible, afficher la page de connexion
            document.getElementById('initialLoader').style.display = 'none';
            document.getElementById('loginPage').style.display = 'flex';
        }
        
        // ========== COMPTES UTILISATEURS - MODIFIEZ ICI ==========
        const USERS = [
            { username: 'admin', password: 'admin123', fullName: 'Administrateur', role: 'admin' },
            { username: 'agent1', password: 'pass123', fullName: 'Agent 1', role: 'agent' },
            { username: 'agent2', password: 'pass456', fullName: 'Agent 2', role: 'agent' }
        ];
        
        // ========== FONCTION DE CONVERSION URL GOOGLE DRIVE ==========
        function convertGoogleDriveUrl(url) {
            if (!url) return '';
            
            url = url.toString().trim();
            
            // Si c'est déjà au bon format thumbnail, retourner tel quel
            if (url.includes('drive.google.com/thumbnail')) {
                return url;
            }
            
            // Extraire l'ID du lien Google Drive
            let fileId = '';
            
            // Format: https://drive.google.com/file/d/ID/view
            if (url.includes('/file/d/')) {
                const match = url.match(/\/file\/d\/([^\/]+)/);
                if (match) fileId = match[1];
            }
            
            // Format: https://drive.google.com/open?id=ID
            else if (url.includes('open?id=')) {
                const match = url.match(/open\?id=([^&]+)/);
                if (match) fileId = match[1];
            }
            
            // Format: https://drive.google.com/uc?export=view&id=ID ou id=ID&export=view
            else if (url.includes('drive.google.com') && url.includes('id=')) {
                const match = url.match(/[?&]id=([^&]+)/);
                if (match) fileId = match[1];
            }
            
            // Si on a trouvé un ID, retourner l'URL directe
            if (fileId) {
                return `https://drive.google.com/thumbnail?id=${fileId}&sz=w500`;
            }
            
            // Sinon retourner l'URL originale
            return url;
        }
        
        let products = JSON.parse(localStorage.getItem('products')) || [];
        let pdvs = JSON.parse(localStorage.getItem('pdvs')) || [
            {id: 'al-baraka', name: 'Al Baraka', location: 'Centre-ville'},
            {id: 'alghafla', name: 'Alghafla', location: 'Zone industrielle'}
        ];
        let movements = JSON.parse(localStorage.getItem('movements')) || [];
        let history = JSON.parse(localStorage.getItem('history')) || [];
        
        // Variables de pagination
        const ITEMS_PER_PAGE = 100;
        let currentPage = {
            products: 1,
            pdv: 1,
            history: 1,
            dashboard: 1
        };
        
        // Fonction de pagination générique
        function paginateData(data, page) {
            const start = (page - 1) * ITEMS_PER_PAGE;
            const end = start + ITEMS_PER_PAGE;
            return data.slice(start, end);
        }
        
        function getTotalPages(totalItems) {
            return Math.ceil(totalItems / ITEMS_PER_PAGE);
        }
        
        function renderPagination(containerId, section, totalItems) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            const totalPages = getTotalPages(totalItems);
            const current = currentPage[section];
            
            if (totalPages <= 1) {
                container.innerHTML = '';
                return;
            }
            
            container.innerHTML = `
                <div style="display:flex;align-items:center;justify-content:center;gap:10px;margin-top:20px;padding:15px;background:#f9fafb;border-radius:8px;">
                    <button onclick="changePage('${section}', ${current - 1})" 
                            class="btn btn-primary" 
                            ${current === 1 ? 'disabled' : ''}
                            style="padding:8px 16px;${current === 1 ? 'opacity:0.5;cursor:not-allowed;' : ''}">
                        ← Précédent
                    </button>
                    <span style="font-weight:bold;color:#374151;min-width:120px;text-align:center;">
                        Page ${current} / ${totalPages}
                    </span>
                    <button onclick="changePage('${section}', ${current + 1})" 
                            class="btn btn-primary" 
                            ${current === totalPages ? 'disabled' : ''}
                            style="padding:8px 16px;${current === totalPages ? 'opacity:0.5;cursor:not-allowed;' : ''}">
                        Suivant →
                    </button>
                    <span style="color:#6b7280;margin-left:10px;">
                        (${totalItems} éléments)
                    </span>
                </div>
            `;
        }
        
        function changePage(section, newPage) {
            const totalPages = getTotalPages(
                section === 'products' ? products.length :
                section === 'history' ? [...movements, ...history].length :
                section === 'pdv' ? products.length :
                section === 'dashboard' ? products.filter(p => {
                    const prodStock = Object.values(p.pdvStock || {}).reduce((s, qty) => s + qty, 0);
                    const minStock = parseInt(p.repetition) || 10;
                    return prodStock < minStock;
                }).length : 0
            );
            
            if (newPage < 1 || newPage > totalPages) return;
            
            currentPage[section] = newPage;
            
            // Rafraîchir la vue appropriée
            if (section === 'products') renderProds();
            else if (section === 'history') filtHist();
            else if (section === 'pdv') renderPdv();
            else if (section === 'dashboard') renderDashboardAlerts();
        }

        function checkAuth() {
            const user = JSON.parse(localStorage.getItem('currentUser'));
            if (!user) {
                showLoginPage();
                return false;
            }
            const userExists = USERS.find(u => u.username === user.username);
            if (!userExists) {
                localStorage.removeItem('currentUser');
                showLoginPage();
                return false;
            }
            document.getElementById('user-name').textContent = user.fullName;
            document.getElementById('user-email').textContent = user.role === 'admin' ? 'Administrateur' : 'Agent';
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            return true;
        }

        function showLoginPage() {
            document.getElementById('loginPage').style.display = 'flex';
            document.getElementById('mainApp').style.display = 'none';
        }

        async function handleLogin(event) {
            event.preventDefault();
            const username = document.getElementById('login-username').value.trim();
            const password = document.getElementById('login-password').value;

            const user = USERS.find(function(u) { return u.username === username && u.password === password; });

            if (user) {
                // Connexion locale
                useSupabase = false;
                const userSession = {
                    username: user.username,
                    fullName: user.fullName,
                    role: user.role
                };
                localStorage.setItem('currentUser', JSON.stringify(userSession));
                document.getElementById('user-name').textContent = user.fullName;
                document.getElementById('user-email').textContent = user.role === 'admin' ? 'Administrateur' : 'Agent';
                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
                renderDash();
            } else if (username.includes('@') && supabaseClient) {
                // Connexion Supabase
                try {
                    console.log('🔵 Connexion Supabase...');
                    const result = await supabaseClient.auth.signInWithPassword({
                        email: username,
                        password: password
                    });
                    
                    if (result.error) throw result.error;
                    
                    currentSupabaseUser = result.data.user;
                    useSupabase = true;
                    
                    // Charger les données depuis Supabase
                    await loadFromSupabase();
                    
                    document.getElementById('user-name').textContent = result.data.user.user_metadata.full_name || 'Utilisateur';
                    document.getElementById('user-email').textContent = result.data.user.email;
                    document.getElementById('loginPage').style.display = 'none';
                    document.getElementById('mainApp').style.display = 'block';
                    
                    // Rendre toutes les sections
                    renderProds();
                    renderPdv();
                    renderMovForm();
                    renderHist();
                    renderDash();
                    
                    console.log('✅ Connexion Supabase réussie');
                } catch (error) {
                    console.error('❌ Erreur:', error);
                    alert('❌ Email ou mot de passe incorrect !');
                }
            } else {
                alert('❌ Nom d\'utilisateur ou mot de passe incorrect !');
            }
        }

        window.addEventListener('DOMContentLoaded', function() {
            if (!checkAuth()) {
                return;
            }
            renderDash();
        });

        async function save() {
            console.log('💾 save() appelée');
            console.log('📊 useSupabase:', useSupabase);
            console.log('👤 currentSupabaseUser:', currentSupabaseUser?.email || currentSupabaseUser?.username);
            console.log('👤 currentUser:', currentUser?.email || currentUser?.username);
            console.log('🔌 supabaseClient:', !!supabaseClient);
            
            // Sauvegarder en local
            localStorage.setItem('products', JSON.stringify(products));
            localStorage.setItem('pdvs', JSON.stringify(pdvs));
            localStorage.setItem('movements', JSON.stringify(movements));
            localStorage.setItem('history', JSON.stringify(history));
            console.log('✅ Sauvegarde localStorage OK');
            
            // Sauvegarder dans Supabase si connecté
            if (useSupabase && (currentSupabaseUser || currentUser) && supabaseClient) {
                try {
                    console.log('🌐 Appel saveToSupabase()...');
                    await saveToSupabase();
                    console.log('✅ Sauvegarde Supabase terminée');
                } catch (error) {
                    console.error('❌ Erreur save():', error);
                }
            } else {
                console.warn('⚠️ Pas de sauvegarde Supabase - conditions non remplies');
            }
        }
        
        async function saveToSupabase() {
            try {
                const userId = currentUser?.id || currentSupabaseUser?.id;
                
                if (!userId) {
                    console.error('❌ Pas de userId - impossible de sauvegarder');
                    return;
                }
                
                console.log('💾 DÉBUT SAUVEGARDE pour user:', userId);
                console.log('📊 Nombre de produits:', products.length);
                console.log('📊 Nombre de PDV:', pdvs.length);
                console.log('📊 Nombre de mouvements:', movements.length);
                console.log('📊 Nombre historique:', history.length);
                
                // 1. SUPPRIMER les anciennes données de CET utilisateur uniquement
                console.log('🗑️ DELETE products...');
                const delProd = await supabaseClient.from('products').delete().eq('user_id', userId);
                console.log('🗑️ DELETE products result:', delProd.error ? 'ERROR: ' + delProd.error.message : 'OK');
                
                console.log('🗑️ DELETE points_vente...');
                const delPdv = await supabaseClient.from('points_vente').delete().eq('user_id', userId);
                console.log('🗑️ DELETE points_vente result:', delPdv.error ? 'ERROR: ' + delPdv.error.message : 'OK');
                
                console.log('🗑️ DELETE movements...');
                const delMov = await supabaseClient.from('movements').delete().eq('user_id', userId);
                console.log('🗑️ DELETE movements result:', delMov.error ? 'ERROR: ' + delMov.error.message : 'OK');
                
                console.log('✅ Anciennes données supprimées');
                
                // 2. Sauvegarder produits avec pdvStock dans warehouse
                console.log('📦 Préparation des produits...');
                if (products.length > 0) {
                    const productsToInsert = products
                        .filter(function(p) { return p.reference && p.reference.trim(); })
                        .map(function(p) {
                            // Calculer le stock total = somme de tous les PDV
                            const totalStock = Object.values(p.pdvStock || {}).reduce((sum, qty) => sum + qty, 0);
                            
                            // Sauvegarder pdvStock en JSON dans le champ warehouse
                            const pdvStockJson = JSON.stringify(p.pdvStock || {});
                            
                            return {
                                user_id: userId,
                                real_name: (p.realName || p.name || 'Produit').substring(0, 255),
                                conventional_name: (p.conventionalName || '').substring(0, 255),
                                reference: p.reference.trim(),
                                barcode: (p.barcode || '').substring(0, 255),
                                quantity: totalStock,
                                min_stock: parseInt(p.repetition) || 10,
                                category: (p.category || '').substring(0, 255),
                                brand: (p.brand || '').substring(0, 255),
                                warehouse: pdvStockJson.substring(0, 1000),
                                image: (p.imageUrl || '').substring(0, 1000)
                            };
                        });
                    
                    console.log('📦 Produits à insérer:', productsToInsert.length);
                    if (productsToInsert.length > 0) {
                        console.log('📦 Premier produit:', JSON.stringify(productsToInsert[0]));
                        const { data, error } = await supabaseClient.from('products').insert(productsToInsert);
                        
                        if (error) {
                            console.error('❌ Erreur sauvegarde produits:', error);
                            console.error('❌ Code:', error.code);
                            console.error('❌ Message:', error.message);
                            console.error('❌ Details:', JSON.stringify(error.details));
                        } else {
                            console.log('✅ Produits sauvegardés:', productsToInsert.length);
                            console.log('✅ Data retournée:', data);
                        }
                    }
                }
                
                // 3. Sauvegarder points de vente
                console.log('🏪 Préparation des PDV...');
                if (pdvs.length > 0) {
                    const pdvsToInsert = pdvs
                        .filter(function(p) { return p.name && p.name.trim(); })
                        .map(function(p) {
                            return {
                                user_id: userId,
                                name: p.name.trim().substring(0, 255),
                                address: (p.location || '').substring(0, 500),
                                phone: p.id || '',
                                email: '',
                                manager: ''
                            };
                        });
                    
                    console.log('🏪 PDV à insérer:', pdvsToInsert.length);
                    if (pdvsToInsert.length > 0) {
                        console.log('🏪 Premier PDV:', JSON.stringify(pdvsToInsert[0]));
                        const { data, error } = await supabaseClient.from('points_vente').insert(pdvsToInsert);
                        if (error) {
                            console.error('❌ Erreur sauvegarde PDV:', error);
                            console.error('❌ Code:', error.code);
                            console.error('❌ Message:', error.message);
                        } else {
                            console.log('✅ PDV sauvegardés:', pdvsToInsert.length);
                            console.log('✅ Data retournée:', data);
                        }
                    }
                }
                
                // 4. Sauvegarder mouvements (Entrées/Sorties) ET historique des transferts
                console.log('📋 Préparation des mouvements...');
                const allData = [];
                
                // Ajouter les mouvements
                movements.forEach(function(m) {
                    // Normaliser le type : in/Entrée/entry → entry, out/Sortie/exit → exit
                    let normalizedType = 'transfer';
                    if (m.type === 'Entrée' || m.type === 'entry' || m.type === 'in') {
                        normalizedType = 'entry';
                    } else if (m.type === 'Sortie' || m.type === 'exit' || m.type === 'out') {
                        normalizedType = 'exit';
                    }
                    
                    allData.push({
                        user_id: userId,
                        product_name: m.productName || m.customer || 'Produit',
                        type: normalizedType,
                        quantity: parseInt(m.quantity) || 0,
                        reason: (m.reason || '').substring(0, 500),
                        customer: (m.customer || '').substring(0, 255),
                        from_location: (m.from || '').substring(0, 255),
                        to_location: (m.to || '').substring(0, 255),
                        date: m.date ? m.date.split('T')[0] : new Date().toISOString().split('T')[0],
                        user_name: m.user || 'Utilisateur'
                    });
                });
                console.log('📋 Mouvements ajoutés:', allData.length);
                
                // Ajouter l'historique (transferts)
                if (history && history.length > 0) {
                    history.forEach(function(h) {
                        allData.push({
                            user_id: userId,
                            product_name: h.productName || 'Produit',
                            type: 'transfer',
                            quantity: parseInt(h.quantity) || 0,
                            reason: '',
                            customer: h.productName || '',
                            from_location: (h.from || 'Stock Central').substring(0, 255),
                            to_location: (h.to || '').substring(0, 255),
                            date: h.date ? h.date.split('T')[0] : new Date().toISOString().split('T')[0],
                            user_name: h.user || 'Utilisateur'
                        });
                    });
                    console.log('📋 Historique ajouté:', history.length);
                }
                console.log('📋 Total mouvements+historique:', allData.length);
                
                if (allData.length > 0) {
                    const validData = allData.filter(function(d) { return d.quantity > 0; });
                    console.log('📋 Mouvements valides (qty>0):', validData.length);
                    if (validData.length > 0) {
                        console.log('📤 INSERTION:', validData.length, 'mouvements');
                        console.log('🔍 Premier mouvement:', JSON.stringify(validData[0]));
                        
                        const { data, error } = await supabaseClient.from('movements').insert(validData);
                        
                        if (error) {
                            console.error('❌ ERREUR INSERT:', error);
                            console.error('❌ Code:', error.code);
                            console.error('❌ Message:', error.message);
                            console.error('❌ Details:', JSON.stringify(error.details));
                            console.error('❌ Hint:', error.hint);
                        } else {
                            console.log('✅ INSERT OK');
                            console.log('✅ Data retournée:', data);
                        }
                    } else {
                        console.log('⚠️ Aucun mouvement valide à sauvegarder');
                    }
                } else {
                    console.log('⚠️ Aucun mouvement à sauvegarder');
                }
                
                console.log('✅ Sauvegarde complète');
                
            } catch (error) {
                console.error('❌ Erreur sauvegarde:', error.message);
            }
        }
        
        // Fonction pour charger depuis Supabase
        async function loadFromSupabase() {
            if (!currentSupabaseUser && !currentUser) return;
            
            try {
                console.log('📥 Chargement depuis Supabase (TOUS les utilisateurs)...');
                
                // Charger TOUS les produits (pas de filtre user_id)
                const { data: prodsData } = await supabaseClient
                    .from('products')
                    .select('*');
                
                // Charger TOUS les PDV (pas de filtre user_id)
                const { data: pdvData } = await supabaseClient
                    .from('points_vente')
                    .select('*');
                
                // Charger TOUS les mouvements (pas de filtre user_id)
                const { data: movData } = await supabaseClient
                    .from('movements')
                    .select('*');
                
                console.log('📥 Données reçues - Produits:', prodsData?.length, '| PDV:', pdvData?.length, '| Mouvements:', movData?.length);
                
                // Convertir produits avec pdvStock - FUSIONNER avec les existants
                if (prodsData && prodsData.length > 0) {
                    const loadedProducts = prodsData.map(function(p) {
                        // Récupérer pdvStock depuis warehouse (stocké en JSON)
                        let pdvStock = {};
                        try {
                            if (p.warehouse && p.warehouse !== 'Entrepôt A') {
                                pdvStock = JSON.parse(p.warehouse);
                            }
                        } catch(e) {
                            pdvStock = {};
                        }
                        
                        return {
                            id: p.id.toString(),
                            name: p.real_name,
                            realName: p.real_name,
                            conventionalName: p.conventional_name || '',
                            reference: p.reference,
                            barcode: p.barcode || '',
                            repetition: p.min_stock || '',
                            quantity: p.quantity,
                            category: p.category || '',
                            brand: p.brand || '',
                            imageUrl: p.image || '',
                            pdvStock: pdvStock
                        };
                    });
                    
                    // REMPLACER products avec les données de Supabase
                    products = loadedProducts;
                    console.log('✅ Produits chargés:', products.length);
                }
                
                // Convertir PDV (récupérer l'ID original depuis phone)
                if (pdvData && pdvData.length > 0) {
                    pdvs = pdvData.map(function(p) {
                        return {
                            id: p.phone || p.id.toString(),
                            name: p.name,
                            location: p.address || ''
                        };
                    });
                    console.log('✅ PDV chargés:', pdvs.length);
                }
                
                // Convertir mouvements et séparer par type
                movements = [];
                history = [];
                
                if (movData && movData.length > 0) {
                    console.log('🔄 Traitement de', movData.length, 'mouvements...');
                    movData.forEach(function(m) {
                        console.log('📋 Type:', m.type, '| Product:', m.product_name);
                        const obj = {
                            id: m.id.toString(),
                            productName: m.product_name || m.customer || 'Produit',
                            quantity: m.quantity,
                            reason: m.reason || '',
                            customer: m.customer || '',
                            from: m.from_location || '',
                            to: m.to_location || '',
                            date: m.date,
                            user: m.user_name || 'Utilisateur'
                        };
                        
                        // Séparer selon le type
                        if (m.type === 'transfer') {
                            obj.type = 'transfer';
                            history.push(obj);
                            console.log('  → Ajouté à HISTORY');
                        } else {
                            obj.type = m.type === 'entry' ? 'Entrée' : 'Sortie';
                            movements.push(obj);
                            console.log('  → Ajouté à MOVEMENTS');
                        }
                    });
                }
                
                console.log('✅ Chargé:', products.length, 'produits,', pdvs.length, 'PDV,', movements.length, 'mouvements,', history.length, 'historique');
                
                // Sauvegarder en local aussi
                localStorage.setItem('products', JSON.stringify(products));
                localStorage.setItem('pdvs', JSON.stringify(pdvs));
                localStorage.setItem('movements', JSON.stringify(movements));
                localStorage.setItem('history', JSON.stringify(history));
            } catch (error) {
                console.error('❌ Erreur chargement:', error);
            }
        }

        function showSection(sec) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(sec).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            event.currentTarget.classList.add('active');

            if (sec === 'dashboard') renderDash();
            if (sec === 'products') renderProds();
            if (sec === 'movements') { renderMovForm(); populateMovProductList(); }
            if (sec === 'transfer') { renderTransForm(); populateTransProductList(); }
            if (sec === 'pdv') renderPdv();
            if (sec === 'history') renderHist();
            if (sec === 'bestsellers') renderBestsellers();
        }

        function renderDash() {
            const total = products.length;
            // Calculer le stock total comme SOMME de tous les PDV pour chaque produit
            const stock = products.reduce((sum, p) => {
                const prodStock = Object.values(p.pdvStock || {}).reduce((s, qty) => s + qty, 0);
                return sum + prodStock;
            }, 0);
            
            // Alertes pour produits dont le stock total (somme PDV) < repetition
            const alertProducts = products.filter(p => {
                const prodStock = Object.values(p.pdvStock || {}).reduce((s, qty) => s + qty, 0);
                const minStock = parseInt(p.repetition) || 10;
                return prodStock < minStock;
            });
            const low = alertProducts.length;

            document.getElementById('dash-content').innerHTML = `
                <input type="text" id="dash-search" class="search-input" placeholder="🔍 Rechercher..." style="width:100%;">
                <div class="stats-grid">
                    <div class="stat-card blue"><div class="stat-label">Total Produits</div><div class="stat-value">${total}</div></div>
                    <div class="stat-card green"><div class="stat-label">Stock Total</div><div class="stat-value">${stock}</div></div>
                    <div class="stat-card red"><div class="stat-label">Alertes Stock</div><div class="stat-value">${low}</div></div>
                    <div class="stat-card orange"><div class="stat-label">Points de Vente</div><div class="stat-value">${pdvs.length}</div></div>
                </div>
                <div class="card">
                    <div class="card-header"><h3 class="card-title">🚨 Alertes Stock (sous le seuil)</h3></div>
                    <div class="table-container">
                        <table>
                            <thead><tr><th>Photo</th><th>Produit</th><th>Référence</th><th>Stock</th><th>Seuil</th></tr></thead>
                            <tbody id="dash-body"></tbody>
                        </table>
                    </div>
                    <div id="dashboard-pagination"></div>
                </div>
            `;
            
            // Render initial des alertes avec pagination
            renderDashboardAlerts();
            
            // Setup recherche
            document.getElementById('dash-search').oninput = function() {
                currentPage.dashboard = 1; // Reset à la page 1 lors de la recherche
                renderDashboardAlerts();
            };
        }
        
        function renderDashboardAlerts() {
            const searchValue = document.getElementById('dash-search')?.value.toLowerCase() || '';
            const isSearching = searchValue.length > 0;
            
            // Filtrer les alertes
            const alertProducts = products.filter(p => {
                const prodStock = Object.values(p.pdvStock || {}).reduce((s, qty) => s + qty, 0);
                const minStock = parseInt(p.repetition) || 10;
                return prodStock < minStock;
            });
            
            // Si recherche → Filtrer par recherche
            let displayAlerts;
            if (isSearching) {
                // RECHERCHE: Afficher tous les résultats filtrés
                displayAlerts = alertProducts.filter(p => 
                    p.name.toLowerCase().includes(searchValue) || 
                    p.reference.toLowerCase().includes(searchValue)
                );
                // Cacher la pagination
                document.getElementById('dashboard-pagination').innerHTML = '';
            } else {
                // PAS DE RECHERCHE: Paginer
                displayAlerts = paginateData(alertProducts, currentPage.dashboard);
                // Afficher la pagination
                renderPagination('dashboard-pagination', 'dashboard', alertProducts.length);
            }
            
            document.getElementById('dash-body').innerHTML = renderAlerts(displayAlerts);
        }

        function renderAlerts(list) {
            if (list.length === 0) return '<tr><td colspan="5" style="text-align:center;">Aucune alerte</td></tr>';
            return list.map(p => {
                const totalStock = Object.values(p.pdvStock || {}).reduce((sum, qty) => sum + qty, 0);
                const minStock = parseInt(p.repetition) || 10;
                
                // Gestion de l'image
                let imgHtml = '<div style="width:50px;height:50px;display:flex;align-items:center;justify-content:center;font-size:30px;margin:auto;">📦</div>';
                
                if (p.imageUrl) {
                    const convertedUrl = convertGoogleDriveUrl(p.imageUrl);
                    
                    if (convertedUrl) {
                        imgHtml = `<img src="${convertedUrl}" 
                                        style="width:50px;height:50px;object-fit:cover;border-radius:8px;cursor:pointer;display:block;margin:auto;" 
                                        onclick="zoomImg('${convertedUrl.replace(/'/g, "\\'")}')"
                                        onerror="this.onerror=null;this.outerHTML='<div style=\\'width:50px;height:50px;display:flex;align-items:center;justify-content:center;font-size:30px;margin:auto;\\'>📦</div>';"
                                        alt="${p.name}">`;
                    }
                }
                
                return `<tr><td style="text-align:center;">${imgHtml}</td><td><strong>${p.name}</strong></td><td>${p.reference}</td><td><span class="badge badge-danger">${totalStock}</span></td><td>${minStock}</td></tr>`;
            }).join('');
        }

        function renderProds() {
            const tbody = document.getElementById('prod-body');
            if (!tbody) return;
            
            const searchInput = document.getElementById('prod-search');
            const searchValue = searchInput ? searchInput.value.toLowerCase() : '';
            const isSearching = searchValue.length > 0;
            
            // Trier les produits par stock total (du plus grand au plus petit)
            const sortedProducts = [...products].sort((a, b) => {
                const stockA = Object.values(a.pdvStock || {}).reduce((sum, qty) => sum + qty, 0);
                const stockB = Object.values(b.pdvStock || {}).reduce((sum, qty) => sum + qty, 0);
                return stockB - stockA; // Ordre décroissant
            });
            
            // Si recherche → Afficher TOUS les résultats, sinon → Paginer
            let displayProducts;
            if (isSearching) {
                // RECHERCHE: Afficher tous les résultats filtrés
                displayProducts = sortedProducts.filter(p => 
                    p.name.toLowerCase().includes(searchValue) || 
                    p.reference.toLowerCase().includes(searchValue) || 
                    (p.barcode && p.barcode.toString().toLowerCase().includes(searchValue))
                );
                // Cacher la pagination
                document.getElementById('products-pagination').innerHTML = '';
            } else {
                // PAS DE RECHERCHE: Paginer
                displayProducts = paginateData(sortedProducts, currentPage.products);
                // Afficher la pagination
                renderPagination('products-pagination', 'products', sortedProducts.length);
            }
            
            tbody.innerHTML = displayProducts.map(p => {
                let imgHtml = '<div style="width:50px;height:50px;display:flex;align-items:center;justify-content:center;font-size:30px;margin:auto;">📦</div>';
                
                if (p.imageUrl) {
                    const convertedUrl = convertGoogleDriveUrl(p.imageUrl);
                    
                    if (convertedUrl) {
                        imgHtml = `<img src="${convertedUrl}" 
                                        style="width:50px;height:50px;object-fit:cover;border-radius:8px;cursor:pointer;display:block;margin:auto;" 
                                        onclick="zoomImg('${convertedUrl.replace(/'/g, "\\'")}')"
                                        onerror="this.onerror=null;this.outerHTML='<div style=\\'width:50px;height:50px;display:flex;align-items:center;justify-content:center;font-size:30px;margin:auto;\\'>📦</div>';"
                                        alt="${p.name}">`;
                    }
                }
                
                // Calculer le stock total = SOMME de tous les PDV
                const totalStock = Object.values(p.pdvStock || {}).reduce((sum, qty) => sum + qty, 0);
                
                return `<tr>
                    <td style="text-align:center;"><input type="checkbox" class="product-checkbox" data-product-id="${p.id}"></td>
                    <td style="text-align:center;">${imgHtml}</td>
                    <td><strong>${p.name}</strong></td>
                    <td>${p.reference}</td>
                    <td>${p.barcode || '-'}</td>
                    <td><span class="badge badge-success">${totalStock}</span></td>
                    <td>${p.repetition || '-'}</td>
                    <td>
                        <button onclick="editProduct('${p.id}')" class="btn-edit">✏️</button>
                        <button onclick="quickTransferToPdv('${p.id}')" class="btn-edit" style="background:#f59e0b;" title="Transférer vers PDV">🚚</button>
                        <button onclick="deleteProduct('${p.id}')" class="btn-delete">🗑️</button>
                    </td>
                </tr>`;
            }).join('');

            // Setup recherche
            if (!searchInput.onInputSet) {
                searchInput.oninput = function() {
                    currentPage.products = 1; // Reset à la page 1 lors de la recherche
                    renderProds();
                };
                searchInput.onInputSet = true;
            }
        }

        function zoomImg(url) {
            if (!url || url.trim().length === 0) {
                alert('❌ Aucune image disponible');
                return;
            }
            
            const cleanUrl = url.trim();
            const overlay = document.createElement('div');
            overlay.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.95);display:flex;align-items:center;justify-content:center;z-index:10000;cursor:pointer;';
            
            const img = document.createElement('img');
            img.src = cleanUrl;
            img.style.cssText = 'max-width:90%;max-height:90%;object-fit:contain;border-radius:8px;box-shadow:0 20px 60px rgba(0,0,0,0.5);';
            img.onerror = function() {
                overlay.remove();
                alert('❌ Impossible de charger l\'image.\n\nVérifiez que l\'image est publique sur Google Drive');
            };
            
            overlay.appendChild(img);
            overlay.onclick = () => overlay.remove();
            document.body.appendChild(overlay);
        }
        
        // Fonctions de sélection multiple des produits
        function toggleAllProducts(checked) {
            document.querySelectorAll('.product-checkbox').forEach(cb => cb.checked = checked);
        }
        
        function selectAllProducts() {
            document.getElementById('select-all-checkbox').checked = true;
            toggleAllProducts(true);
        }
        
        async function deleteSelectedProducts() {
            const selected = Array.from(document.querySelectorAll('.product-checkbox:checked'))
                .map(cb => cb.dataset.productId);
            
            if (selected.length === 0) {
                alert('⚠️ Aucun produit sélectionné !');
                return;
            }
            
            if (!confirm(`🗑️ Voulez-vous vraiment supprimer ${selected.length} produit(s) ?\n\nCette action est irréversible !`)) {
                return;
            }
            
            products = products.filter(p => !selected.includes(p.id));
            await save();
            renderProds();
            
            alert(`✅ ${selected.length} produit(s) supprimé(s) !`);
        }
        
        // ========== FONCTIONS POUR ENTRÉES (Dropdown produits) ==========
        function renderMovEntryList() {
            const list = document.getElementById('mov-entry-product-list');
            if (!list) return;
            
            // Trier par nom
            const sorted = [...products].sort((a, b) => a.name.localeCompare(b.name));
            
            list.innerHTML = `
                <div class="custom-select-item" data-value="NEW" onclick="selectMovEntryProduct('NEW', '➕ Créer nouveau produit')" style="background:#10b981;color:white;font-weight:bold;">
                    ➕ Créer nouveau produit
                </div>
                <div style="height:1px;background:#e5e7eb;margin:4px 0;"></div>
                ${sorted.map(p => `
                    <div class="custom-select-item" data-value="${p.id}" onclick="selectMovEntryProduct('${p.id}', '${p.name.replace(/'/g, "\\'")} (${p.reference})')">
                        <strong>${p.name}</strong>
                        <span style="color:#6b7280;font-size:0.85rem;margin-left:8px;">${p.reference}</span>
                    </div>
                `).join('')}
            `;
        }
        
        function toggleMovEntryDropdown(e) {
            e.stopPropagation();
            const dropdown = document.getElementById('mov-entry-dropdown');
            const button = document.getElementById('mov-entry-select-btn');
            const isOpen = dropdown.classList.contains('show');
            
            // Fermer tous les autres dropdowns
            document.querySelectorAll('.custom-select-dropdown').forEach(d => d.classList.remove('show'));
            document.querySelectorAll('.custom-select-button').forEach(b => b.classList.remove('open'));
            
            if (!isOpen) {
                dropdown.classList.add('show');
                button.classList.add('open');
                document.getElementById('mov-entry-search-input').focus();
            }
        }
        
        function filterMovEntryList() {
            const search = document.getElementById('mov-entry-search-input').value.toLowerCase();
            const items = document.querySelectorAll('#mov-entry-product-list .custom-select-item');
            
            items.forEach(item => {
                const text = item.textContent.toLowerCase();
                if (text.includes(search) || item.dataset.value === 'NEW') {
                    item.style.display = 'flex';
                } else {
                    item.style.display = 'none';
                }
            });
        }
        
        function selectMovEntryProduct(id, displayText) {
            document.getElementById('mov-entry-product').value = id;
            document.getElementById('mov-entry-select-btn').textContent = displayText;
            document.getElementById('mov-entry-dropdown').classList.remove('show');
            document.getElementById('mov-entry-select-btn').classList.remove('open');
            document.getElementById('mov-entry-search-input').value = '';
            
            // Si "Nouveau", afficher les champs référence + nom
            const newReferenceGroup = document.getElementById('mov-new-reference-group');
            const newNameGroup = document.getElementById('mov-new-name-group');
            
            if (id === 'NEW') {
                newReferenceGroup.style.display = 'flex';
                newNameGroup.style.display = 'flex';
                document.getElementById('mov-new-reference').required = true;
                document.getElementById('mov-new-name').required = true;
            } else {
                newReferenceGroup.style.display = 'none';
                newNameGroup.style.display = 'none';
                document.getElementById('mov-new-reference').required = false;
                document.getElementById('mov-new-name').required = false;
            }
            
            // Render la liste complète
            renderMovEntryList();
        }

        function openModal(id) {
            document.getElementById(id).style.display = 'flex';
        }

        function closeModal(id) {
            document.getElementById(id).style.display = 'none';
            if (id === 'productModal') {
                document.getElementById('edit-id').value = '';
                document.getElementById('p-name').value = '';
                document.getElementById('p-ref').value = '';
                document.getElementById('p-qty').value = '0';
                document.getElementById('p-rep').value = '';
                document.getElementById('p-barcode').value = '';
                document.getElementById('p-category').value = '';
                document.getElementById('p-brand').value = '';
                document.getElementById('p-img').value = '';
            }
            if (id === 'pdvModal') {
                document.getElementById('pdv-edit-id').value = '';
                document.getElementById('pdv-name').value = '';
                document.getElementById('pdv-location').value = '';
            }
        }

        function saveProduct(e) {
            e.preventDefault();
            const id = document.getElementById('edit-id').value || Date.now().toString();
            const name = document.getElementById('p-name').value.trim();
            const reference = document.getElementById('p-ref').value.trim();
            const quantity = parseInt(document.getElementById('p-qty').value) || 0;
            const repetition = document.getElementById('p-rep').value.trim();
            const barcode = document.getElementById('p-barcode').value.trim();
            const category = document.getElementById('p-category').value.trim();
            const brand = document.getElementById('p-brand').value.trim();
            let imageUrl = document.getElementById('p-img').value.trim();
            
            // Convertir l'URL Google Drive
            if (imageUrl) {
                imageUrl = convertGoogleDriveUrl(imageUrl);
            }

            const existing = products.find(p => p.id === id);
            if (existing) {
                existing.name = name;
                existing.reference = reference;
                existing.quantity = quantity;
                existing.repetition = repetition;
                existing.barcode = barcode;
                existing.category = category;
                existing.brand = brand;
                existing.imageUrl = imageUrl;
            } else {
                products.push({
                    id,
                    name,
                    reference,
                    quantity,
                    repetition,
                    barcode,
                    category,
                    brand,
                    imageUrl,
                    pdvStock: {}
                });
            }

            save();
            closeModal('productModal');
            renderProds();
            alert('✅ Produit enregistré avec succès !');
        }

        function editProduct(id) {
            const p = products.find(x => x.id === id);
            if (!p) return;
            document.getElementById('edit-id').value = p.id;
            document.getElementById('p-name').value = p.name;
            document.getElementById('p-ref').value = p.reference;
            document.getElementById('p-qty').value = p.quantity || 0;
            document.getElementById('p-rep').value = p.repetition || '';
            document.getElementById('p-barcode').value = p.barcode || '';
            document.getElementById('p-category').value = p.category || '';
            document.getElementById('p-brand').value = p.brand || '';
            document.getElementById('p-img').value = p.imageUrl || '';
            openModal('productModal');
        }

        function deleteProduct(id) {
            if (!confirm('Supprimer ce produit ?')) return;
            products = products.filter(p => p.id !== id);
            save();
            renderProds();
        }

        async function quickTransferToPdv(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) {
                alert('❌ Produit introuvable !');
                return;
            }

            if (pdvs.length === 0) {
                alert('❌ Aucun point de vente disponible !\n\nVeuillez d\'abord créer un PDV dans l\'onglet "Points de Vente".');
                return;
            }

            const currentStock = product.quantity || 0;
            if (currentStock === 0) {
                alert('❌ Stock total est à 0 !\n\nIl n\'y a rien à transférer.');
                return;
            }

            // Créer la liste des PDV
            let pdvOptions = pdvs.map((pdv, index) => `${index + 1}. ${pdv.name}`).join('\n');
            
            let choice = prompt(`🚚 TRANSFERT RAPIDE - ${product.name}\n\nStock total disponible: ${currentStock}\n\nChoisissez le PDV de destination:\n\n${pdvOptions}\n\nEntrez le numéro du PDV:`);
            
            if (!choice) return;
            
            const pdvIndex = parseInt(choice) - 1;
            if (isNaN(pdvIndex) || pdvIndex < 0 || pdvIndex >= pdvs.length) {
                alert('❌ Numéro de PDV invalide !');
                return;
            }

            const selectedPdv = pdvs[pdvIndex];
            
            const qty = prompt(`📦 Quantité à transférer vers "${selectedPdv.name}":\n\nStock total disponible: ${currentStock}\n\nEntrez la quantité (ou laissez vide pour tout transférer):`);
            
            if (qty === null) return;
            
            const transferQty = qty === '' ? currentStock : parseInt(qty);
            
            if (isNaN(transferQty) || transferQty <= 0) {
                alert('❌ Quantité invalide !');
                return;
            }

            if (transferQty > currentStock) {
                alert(`❌ Quantité insuffisante !\n\nStock disponible: ${currentStock}\nQuantité demandée: ${transferQty}`);
                return;
            }

            // Effectuer le transfert - NE PAS DIMINUER LE STOCK TOTAL !
            // Le stock total reste le même, on déplace juste entre PDV
            if (!product.pdvStock) product.pdvStock = {};
            product.pdvStock[selectedPdv.id] = (product.pdvStock[selectedPdv.id] || 0) + transferQty;

            // Enregistrer dans l'historique
            const now = new Date();
            history.push({
                date: now.toISOString(),
                productId: product.id,
                productName: product.name,
                type: 'transfer',
                quantity: transferQty,
                from: 'Stock Central',
                to: selectedPdv.name,
                user: document.getElementById('user-name').textContent
            });
            
            console.log('📝 Historique après push:', history.length);
            console.log('📋 Dernier élément:', JSON.stringify(history[history.length - 1]));

            // ATTENDRE que la sauvegarde finisse !
            await save();
            
            // RAFRAÎCHIR L'HISTORIQUE EN TEMPS RÉEL !
            if (document.getElementById('history').classList.contains('active')) {
                renderHist();
            }
            
            renderProds();
            
            // Calculer le nouveau stock total (somme de tous les PDV)
            const totalStock = Object.values(product.pdvStock || {}).reduce((sum, qty) => sum + qty, 0);
            product.quantity = totalStock;
            
            alert(`✅ Transfert réussi !\n\n${transferQty} unité(s) transféré(es) vers "${selectedPdv.name}"\n\nStock total: ${totalStock}\nStock ${selectedPdv.name}: ${product.pdvStock[selectedPdv.id]}`);
        }

        // Custom Select Dropdown pour Mouvements
        function toggleMovDropdown(e) {
            e.stopPropagation();
            const dropdown = document.getElementById('mov-dropdown');
            const btn = document.getElementById('mov-select-btn');
            
            if (dropdown.classList.contains('show')) {
                dropdown.classList.remove('show');
                btn.classList.remove('open');
            } else {
                dropdown.classList.add('show');
                btn.classList.add('open');
                populateMovProductList();
                document.getElementById('mov-search-input').focus();
            }
        }

        function populateMovProductList() {
            const list = document.getElementById('mov-product-list');
            list.innerHTML = products.map(p => `
                <div class="custom-select-item" onclick="selectMovProduct('${p.id}', '${p.name.replace(/'/g, "\\'")} (${p.reference})')">
                    ${p.name} (${p.reference})
                </div>
            `).join('');
        }

        function filterMovList() {
            const search = document.getElementById('mov-search-input').value.toLowerCase();
            const filtered = products.filter(p => 
                p.name.toLowerCase().includes(search) || 
                p.reference.toLowerCase().includes(search) ||
                (p.barcode && p.barcode.toLowerCase().includes(search))
            );
            
            const list = document.getElementById('mov-product-list');
            list.innerHTML = filtered.map(p => `
                <div class="custom-select-item" onclick="selectMovProduct('${p.id}', '${p.name.replace(/'/g, "\\'")} (${p.reference})')">
                    ${p.name} (${p.reference})
                </div>
            `).join('');
        }

        function selectMovProduct(id, label) {
            document.getElementById('mov-product').value = id;
            document.getElementById('mov-select-btn').textContent = label;
            document.getElementById('mov-dropdown').classList.remove('show');
            document.getElementById('mov-select-btn').classList.remove('open');
        }

        // Custom Select Dropdown pour Transferts
        function toggleTransDropdown(e) {
            e.stopPropagation();
            const dropdown = document.getElementById('trans-dropdown');
            const btn = document.getElementById('trans-select-btn');
            
            if (dropdown.classList.contains('show')) {
                dropdown.classList.remove('show');
                btn.classList.remove('open');
            } else {
                dropdown.classList.add('show');
                btn.classList.add('open');
                populateTransProductList();
                document.getElementById('trans-search-input').focus();
            }
        }

        function populateTransProductList() {
            const list = document.getElementById('trans-product-list');
            list.innerHTML = products.map(p => `
                <div class="custom-select-item" onclick="selectTransProduct('${p.id}', '${p.name.replace(/'/g, "\\'")} (${p.reference})')">
                    ${p.name} (${p.reference})
                </div>
            `).join('');
        }

        function filterTransList() {
            const search = document.getElementById('trans-search-input').value.toLowerCase();
            const filtered = products.filter(p => 
                p.name.toLowerCase().includes(search) || 
                p.reference.toLowerCase().includes(search) ||
                (p.barcode && p.barcode.toLowerCase().includes(search))
            );
            
            const list = document.getElementById('trans-product-list');
            list.innerHTML = filtered.map(p => `
                <div class="custom-select-item" onclick="selectTransProduct('${p.id}', '${p.name.replace(/'/g, "\\'")} (${p.reference})')">
                    ${p.name} (${p.reference})
                </div>
            `).join('');
        }

        function selectTransProduct(id, label) {
            document.getElementById('trans-product').value = id;
            document.getElementById('trans-select-btn').textContent = label;
            document.getElementById('trans-dropdown').classList.remove('show');
            document.getElementById('trans-select-btn').classList.remove('open');
        }

        // Fermer les dropdowns en cliquant ailleurs
        document.addEventListener('click', function() {
            document.querySelectorAll('.custom-select-dropdown').forEach(d => d.classList.remove('show'));
            document.querySelectorAll('.custom-select-button').forEach(b => b.classList.remove('open'));
        });

        function renderMovForm() {
            const pdvSelect = document.getElementById('mov-pdv');
            pdvSelect.innerHTML = '<option value="">Sélectionner...</option>' + 
                pdvs.map(v => `<option value="${v.id}">${v.name}</option>`).join('');
        }

        function toggleMovementType() {
            const type = document.getElementById('mov-type').value;
            
            // Groupes de champs
            const entryProductGroup = document.getElementById('mov-entry-product-group');
            const newReferenceGroup = document.getElementById('mov-new-reference-group');
            const newNameGroup = document.getElementById('mov-new-name-group');
            const productGroup = document.getElementById('mov-product-group');
            const paymentGroup = document.getElementById('mov-payment-group');
            
            if (type === 'in') {
                // ENTRÉE: Afficher dropdown sélection, cacher sorties
                entryProductGroup.style.display = 'flex';
                newReferenceGroup.style.display = 'none';
                newNameGroup.style.display = 'none';
                productGroup.style.display = 'none';
                paymentGroup.style.display = 'none';
                
                // Render la liste des produits pour les entrées
                renderMovEntryList();
                
                // Champs requis
                document.getElementById('mov-entry-product').required = true;
                document.getElementById('mov-product').required = false;
                document.getElementById('mov-payment').required = false;
                
            } else if (type === 'out') {
                // SORTIE: Afficher Produit + Paiement, cacher entrées
                entryProductGroup.style.display = 'none';
                newReferenceGroup.style.display = 'none';
                newNameGroup.style.display = 'none';
                productGroup.style.display = 'flex';
                paymentGroup.style.display = 'flex';
                
                // Champs requis
                document.getElementById('mov-entry-product').required = false;
                document.getElementById('mov-product').required = true;
                document.getElementById('mov-payment').required = true;
                
            } else {
                // Rien sélectionné: Tout cacher
                entryProductGroup.style.display = 'none';
                newReferenceGroup.style.display = 'none';
                newNameGroup.style.display = 'none';
                productGroup.style.display = 'none';
                paymentGroup.style.display = 'none';
            }
        }


        async function addMovement(e) {
            e.preventDefault();
            const type = document.getElementById('mov-type').value;
            const pdvId = document.getElementById('mov-pdv').value;
            const quantity = parseInt(document.getElementById('mov-quantity').value);
            const reason = document.getElementById('mov-reason').value.trim();
            const note = document.getElementById('mov-note').value.trim();
            
            const pdv = pdvs.find(v => v.id === pdvId);
            if (!pdv) {
                alert('❌ PDV invalide');
                return;
            }
            
            let product;
            let productId;
            
            if (type === 'in') {
                // ==================== ENTRÉE ====================
                const selectedProductId = document.getElementById('mov-entry-product').value;
                
                if (!selectedProductId) {
                    alert('❌ Veuillez sélectionner un produit ou créer un nouveau');
                    return;
                }
                
                if (selectedProductId === 'NEW') {
                    // CRÉER NOUVEAU PRODUIT
                    const reference = document.getElementById('mov-new-reference').value.trim().toUpperCase();
                    const productName = document.getElementById('mov-new-name').value.trim();
                    
                    if (!reference || !productName) {
                        alert('❌ Veuillez saisir la référence et le nom du produit');
                        return;
                    }
                    
                    // Vérifier si la référence existe déjà
                    const existingProduct = products.find(p => p.reference.toUpperCase() === reference);
                    if (existingProduct) {
                        alert(`❌ Cette référence existe déjà !\n\nProduit: ${existingProduct.name}\nRéférence: ${existingProduct.reference}\n\nVeuillez sélectionner le produit existant dans la liste.`);
                        return;
                    }
                    
                    // Créer le nouveau produit
                    productId = Date.now().toString();
                    product = {
                        id: productId,
                        name: productName,
                        realName: productName,
                        conventionalName: '',
                        reference: reference,
                        barcode: '',
                        repetition: '',
                        quantity: 0,
                        category: '',
                        brand: '',
                        imageUrl: '',
                        pdvStock: {}
                    };
                    
                    products.push(product);
                    console.log('✅ Nouveau produit créé:', productName, reference);
                    
                } else {
                    // PRODUIT EXISTANT
                    product = products.find(p => p.id === selectedProductId);
                    if (!product) {
                        alert('❌ Produit invalide');
                        return;
                    }
                    productId = product.id;
                    console.log('✅ Produit existant sélectionné:', product.name);
                }
                
                // Initialiser pdvStock si nécessaire
                if (!product.pdvStock) product.pdvStock = {};
                if (!product.pdvStock[pdvId]) product.pdvStock[pdvId] = 0;
                
                // Ajouter au stock
                product.pdvStock[pdvId] += quantity;
                product.quantity = (product.quantity || 0) + quantity;
                
                // Enregistrer dans movements
                movements.push({
                    id: Date.now().toString(),
                    type: 'Entrée',
                    productName: product.name,
                    productId: productId,
                    customer: pdv.name,
                    quantity: quantity,
                    reason: reason || '',
                    from: pdv.name,
                    to: '',
                    user: document.getElementById('user-name').textContent,
                    date: new Date().toISOString()
                });
                
                await save();
                
                // RAFRAÎCHIR
                if (document.getElementById('history').classList.contains('active')) {
                    renderHist();
                }
                renderProds();
                
                e.target.reset();
                document.getElementById('mov-entry-select-btn').textContent = 'Sélectionner ou créer un produit...';
                document.getElementById('mov-entry-product').value = '';
                toggleMovementType(); // Reset l'affichage
                alert(`✅ Entrée enregistrée !\n\nProduit: ${product.name}\nRéférence: ${product.reference}\nStock ${pdv.name}: ${product.pdvStock[pdvId]}`);
                
            } else if (type === 'out') {
                // ==================== SORTIE ====================
                productId = document.getElementById('mov-product').value;
                const payment = document.getElementById('mov-payment').value;
                
                if (!productId || !payment) {
                    alert('❌ Veuillez sélectionner un produit et un mode de paiement');
                    return;
                }
                
                product = products.find(p => p.id === productId);
                
                if (!product) {
                    alert('❌ Produit invalide');
                    return;
                }
                
                if (!product.pdvStock) product.pdvStock = {};
                if (!product.pdvStock[pdvId]) product.pdvStock[pdvId] = 0;
                
                if (product.pdvStock[pdvId] < quantity) {
                    alert(`❌ Stock insuffisant dans ce PDV\n\nStock actuel: ${product.pdvStock[pdvId]}\nDemandé: ${quantity}`);
                    return;
                }
                
                // Retirer du stock
                product.pdvStock[pdvId] -= quantity;
                product.quantity = (product.quantity || 0) - quantity;
                
                // Enregistrer dans movements
                movements.push({
                    id: Date.now().toString(),
                    type: 'Sortie',
                    productName: product.name,
                    productId: productId,
                    customer: pdv.name + ' / ' + payment,
                    quantity: quantity,
                    reason: reason || '',
                    from: '',
                    to: pdv.name,
                    user: document.getElementById('user-name').textContent,
                    date: new Date().toISOString()
                });
                
                await save();
                
                // RAFRAÎCHIR
                if (document.getElementById('history').classList.contains('active')) {
                    renderHist();
                }
                
                e.target.reset();
                document.getElementById('mov-select-btn').textContent = 'Sélectionner un produit...';
                document.getElementById('mov-product').value = '';
                toggleMovementType(); // Reset l'affichage
                alert(`✅ Sortie enregistrée !\n\nStock ${pdv.name}: ${product.pdvStock[pdvId]}`);
            }
        }

        function renderTransForm() {
            const fromSelect = document.getElementById('trans-from');
            const toSelect = document.getElementById('trans-to');
            
            fromSelect.innerHTML = '<option value="">Sélectionner...</option>' + 
                pdvs.map(v => `<option value="${v.id}">${v.name}</option>`).join('');
            toSelect.innerHTML = '<option value="">Sélectionner...</option>' + 
                pdvs.map(v => `<option value="${v.id}">${v.name}</option>`).join('');
        }

        async function addTransfer(e) {
            e.preventDefault();
            const productId = document.getElementById('trans-product').value;
            const fromId = document.getElementById('trans-from').value;
            const toId = document.getElementById('trans-to').value;
            const quantity = parseInt(document.getElementById('trans-quantity').value);
            const note = document.getElementById('trans-note').value.trim();

            if (fromId === toId) {
                alert('❌ Source et destination doivent être différentes');
                return;
            }

            const product = products.find(p => p.id === productId);
            const fromPdv = pdvs.find(v => v.id === fromId);
            const toPdv = pdvs.find(v => v.id === toId);

            if (!product || !fromPdv || !toPdv) {
                alert('❌ Sélection invalide');
                return;
            }

            if (!product.pdvStock) product.pdvStock = {};
            if (!product.pdvStock[fromId]) product.pdvStock[fromId] = 0;
            if (!product.pdvStock[toId]) product.pdvStock[toId] = 0;

            if (product.pdvStock[fromId] < quantity) {
                alert('❌ Stock insuffisant dans le PDV source');
                return;
            }

            product.pdvStock[fromId] -= quantity;
            product.pdvStock[toId] += quantity;

            history.push({
                id: Date.now().toString(),
                type: 'transfer',
                productName: product.name,
                productId: productId,
                from: fromPdv.name,
                to: toPdv.name,
                quantity: quantity,
                user: document.getElementById('user-name').textContent,
                date: new Date().toISOString()
            });

            await save();
            
            // RAFRAÎCHIR L'HISTORIQUE EN TEMPS RÉEL !
            if (document.getElementById('history').classList.contains('active')) {
                renderHist();
            }
            
            e.target.reset();
            document.getElementById('trans-select-btn').textContent = 'Sélectionner un produit...';
            document.getElementById('trans-product').value = '';
            alert(`✅ Transfert réussi ! ${fromPdv.name} → ${toPdv.name}`);
        }

        function renderPdv() {
            const searchTerm = document.getElementById('pdv-search')?.value.toLowerCase() || '';
            const isSearching = searchTerm.length > 0;
            const thead = document.getElementById('pdv-table-header');
            const tbody = document.getElementById('pdv-products-table');
            
            if (!thead || !tbody) return;
            
            // Créer l'en-tête avec une colonne par PDV + bouton supprimer
            thead.innerHTML = `
                <tr>
                    <th>Produit</th>
                    <th>Référence</th>
                    <th>QTY Total</th>
                    ${pdvs.map(pdv => `
                        <th style="color:#667eea;">
                            <div style="display:flex;align-items:center;justify-content:space-between;gap:8px;">
                                <span>🏪 ${pdv.name}</span>
                                <button onclick="deletePdv('${pdv.id}')" class="btn-delete" style="font-size:12px;padding:4px 8px;" title="Supprimer ce PDV">🗑️</button>
                            </div>
                        </th>
                    `).join('')}
                </tr>
            `;
            
            // Filtrer les produits
            const filtered = products.filter(p => {
                if (!searchTerm) return true;
                return p.name.toLowerCase().includes(searchTerm) || 
                       p.reference.toLowerCase().includes(searchTerm);
            });
            
            // TRIER par quantité totale (du plus grand au plus petit)
            const sortedFiltered = filtered.sort((a, b) => {
                const qtyA = Object.values(a.pdvStock || {}).reduce((sum, qty) => sum + qty, 0);
                const qtyB = Object.values(b.pdvStock || {}).reduce((sum, qty) => sum + qty, 0);
                return qtyB - qtyA; // Ordre décroissant
            });
            
            // Si pas de résultats
            if (sortedFiltered.length === 0) {
                tbody.innerHTML = `<tr><td colspan="${3 + pdvs.length}" style="text-align:center;padding:30px;color:#6b7280;">Aucun produit trouvé</td></tr>`;
                document.getElementById('pdv-pagination').innerHTML = '';
                return;
            }
            
            // Si recherche → Afficher TOUS les résultats, sinon → Paginer
            let displayProducts;
            if (isSearching) {
                // RECHERCHE: Afficher tous les résultats filtrés
                displayProducts = sortedFiltered;
                // Cacher la pagination
                document.getElementById('pdv-pagination').innerHTML = '';
            } else {
                // PAS DE RECHERCHE: Paginer
                displayProducts = paginateData(sortedFiltered, currentPage.pdv);
                // Afficher la pagination
                renderPagination('pdv-pagination', 'pdv', sortedFiltered.length);
            }
            
            tbody.innerHTML = displayProducts.map(product => {
                const pdvColumns = pdvs.map(pdv => {
                    const qty = product.pdvStock?.[pdv.id] || 0;
                    return `<td style="text-align:center;">
                        ${qty > 0 ? 
                            `<span style="background:#3b82f6;color:white;padding:6px 14px;border-radius:8px;font-weight:bold;">${qty}</span>` : 
                            '<span style="color:#9ca3af;">-</span>'}
                    </td>`;
                }).join('');
                
                return `
                    <tr>
                        <td><strong>${product.name}</strong></td>
                        <td>${product.reference}</td>
                        <td><span class="badge badge-success">${product.quantity || 0}</span></td>
                        ${pdvColumns}
                    </tr>
                `;
            }).join('');
        }

        function savePdv(e) {
            e.preventDefault();
            const id = document.getElementById('pdv-edit-id').value || Date.now().toString();
            const name = document.getElementById('pdv-name').value.trim();
            const location = document.getElementById('pdv-location').value.trim();

            const existing = pdvs.find(p => p.id === id);
            if (existing) {
                existing.name = name;
                existing.location = location;
            } else {
                pdvs.push({ id, name, location });
            }

            save();
            closeModal('pdvModal');
            renderPdv();
            alert('✅ PDV enregistré !');
        }

        function editPdv(id) {
            const p = pdvs.find(x => x.id === id);
            if (!p) return;
            document.getElementById('pdv-edit-id').value = p.id;
            document.getElementById('pdv-name').value = p.name;
            document.getElementById('pdv-location').value = p.location || '';
            openModal('pdvModal');
        }

        async function deletePdv(id) {
            const pdv = pdvs.find(p => p.id === id);
            if (!pdv) return;
            
            // Vérifier s'il y a du stock dans ce PDV
            const hasStock = products.some(p => (p.pdvStock?.[id] || 0) > 0);
            
            let message = `🗑️ Supprimer le PDV "${pdv.name}" ?`;
            if (hasStock) {
                message += '\n\n⚠️ ATTENTION : Ce PDV contient du stock !\nLe stock sera perdu.';
            }
            message += '\n\nCette action est irréversible !';
            
            if (!confirm(message)) return;
            
            // Supprimer le PDV
            pdvs = pdvs.filter(p => p.id !== id);
            
            // Supprimer le stock de ce PDV dans tous les produits
            products.forEach(p => {
                if (p.pdvStock && p.pdvStock[id]) {
                    delete p.pdvStock[id];
                }
            });
            
            await save();
            renderPdv();
            alert(`✅ PDV "${pdv.name}" supprimé !`);
        }

        function renderHist() {
            console.log('🔍 renderHist() appelé - history.length:', history.length);
            console.log('📋 history:', JSON.stringify(history));
            
            const years = getYrs();
            document.getElementById('hy').innerHTML = '<option value="">Toutes les années</option>' + 
                years.map(y => `<option value="${y}">${y}</option>`).join('');
            filtHist();
            
            ['hs', 'ht', 'hd', 'hm', 'hy'].forEach(id => {
                document.getElementById(id).addEventListener('input', function() {
                    currentPage.history = 1; // Reset à la page 1 lors du filtrage
                    filtHist();
                });
            });
        }

        function filtHist() {
            console.log('🔍 filtHist() appelé');
            console.log('📊 movements.length:', movements.length);
            console.log('📊 history.length:', history.length);
            
            const s = document.getElementById('hs').value.toLowerCase();
            const t = document.getElementById('ht').value; // Filtre type
            const d = document.getElementById('hd').value;
            const m = document.getElementById('hm').value;
            const y = document.getElementById('hy').value;
            
            const isFiltering = s || t || d || m || y; // Détecte si un filtre est actif
            
            // COMBINER movements + history pour voir TOUS les mouvements !
            const allMovements = [...movements, ...history];
            console.log('📊 allMovements.length:', allMovements.length);
            
            const sorted = allMovements.sort((a, b) => new Date(b.date) - new Date(a.date));
            console.log('📊 sorted.length:', sorted.length);
            
            const filtered = sorted.filter(mov => {
                const date = new Date(mov.date);
                
                // Normaliser le type pour la comparaison
                let movType = '';
                if (mov.type === 'transfer' || mov.type === 'Transfert') {
                    movType = 'Transfert';
                } else if (mov.type === 'Entrée' || mov.type === 'entry' || mov.type === 'in') {
                    movType = 'Entrée';
                } else if (mov.type === 'Sortie' || mov.type === 'exit' || mov.type === 'out') {
                    movType = 'Sortie';
                }
                
                const matchSearch = !s || 
                    (mov.productName && mov.productName.toLowerCase().includes(s)) || 
                    (mov.customer && mov.customer.toLowerCase().includes(s)) ||
                    (mov.from && mov.from.toLowerCase().includes(s)) ||
                    (mov.to && mov.to.toLowerCase().includes(s));
                const matchType = !t || movType === t; // Nouveau filtre
                const matchDate = !d || date.toISOString().split('T')[0] === d;
                const matchMonth = !m || date.getMonth() === parseInt(m);
                const matchYear = !y || date.getFullYear() === parseInt(y);
                return matchSearch && matchType && matchDate && matchMonth && matchYear;
            });
            
            console.log('✅ filtered.length:', filtered.length);
            
            // Si filtre actif → Afficher TOUS les résultats, sinon → Paginer
            let displayMovements;
            if (isFiltering) {
                // FILTRAGE: Afficher tous les résultats filtrés
                displayMovements = filtered;
                // Cacher la pagination
                document.getElementById('history-pagination').innerHTML = '';
            } else {
                // PAS DE FILTRE: Paginer
                displayMovements = paginateData(filtered, currentPage.history);
                // Afficher la pagination
                renderPagination('history-pagination', 'history', filtered.length);
            }
            
            document.getElementById('hist-body').innerHTML = renderHistTable(displayMovements);
        }

        function renderHistTable(list) {
            if (!list || list.length === 0) return '<tr><td colspan="8" style="text-align:center;">Aucun mouvement</td></tr>';
            return list.map(m => {
                // Déterminer le type de mouvement - supporter TOUS les formats
                let ic, cl, tp, detail;
                
                const type = m.type ? m.type.toLowerCase() : '';
                
                if (type === 'transfer') {
                    ic = '🚚';
                    cl = '#f59e0b';
                    tp = 'Transfert';
                    detail = `${m.from || 'Stock Central'} → ${m.to || '-'}`;
                } else if (type === 'entrée' || type === 'entry' || type === 'in') {
                    ic = '📥';
                    cl = '#10b981';
                    tp = 'Entrée';
                    detail = m.customer || m.from || '-';
                } else if (type === 'sortie' || type === 'exit' || type === 'out') {
                    ic = '📤';
                    cl = '#ef4444';
                    tp = 'Sortie';
                    detail = m.customer || m.to || '-';
                } else {
                    ic = '❓';
                    cl = '#6b7280';
                    tp = type || 'Inconnu';
                    detail = '-';
                }
                
                // Trouver le produit correspondant pour récupérer son image
                const product = products.find(p => p.name === m.productName || p.id === m.productId);
                
                // Gestion de l'image
                let imgHtml = '<div style="width:50px;height:50px;display:flex;align-items:center;justify-content:center;font-size:30px;margin:auto;">📦</div>';
                
                if (product && product.imageUrl) {
                    const convertedUrl = convertGoogleDriveUrl(product.imageUrl);
                    
                    if (convertedUrl) {
                        imgHtml = `<img src="${convertedUrl}" 
                                        style="width:50px;height:50px;object-fit:cover;border-radius:8px;cursor:pointer;display:block;margin:auto;" 
                                        onclick="zoomImg('${convertedUrl.replace(/'/g, "\\'")}')"
                                        onerror="this.onerror=null;this.outerHTML='<div style=\\'width:50px;height:50px;display:flex;align-items:center;justify-content:center;font-size:30px;margin:auto;\\'>📦</div>';"
                                        alt="${product.name}">`;
                    }
                }
                
                return `<tr>
                    <td>${new Date(m.date).toLocaleString('fr-FR')}</td>
                    <td><span style="color:${cl};font-weight:bold;">${ic} ${tp}</span></td>
                    <td>${m.reason || '-'}</td>
                    <td style="text-align:center;">${imgHtml}</td>
                    <td><strong>${m.productName || 'Produit'}</strong></td>
                    <td><strong style="color:${cl};">${m.quantity}</strong></td>
                    <td>${detail}</td>
                    <td>${m.user || '-'}</td>
                </tr>`;
            }).join('');
        }

        function getYrs() {
            const y = new Set();
            // Combiner movements + history
            [...movements, ...history].forEach(m => y.add(new Date(m.date).getFullYear()));
            return Array.from(y).sort((a, b) => b - a);
        }

        function rstHist() {
            document.getElementById('hs').value = '';
            document.getElementById('ht').value = ''; // Reset filtre type
            document.getElementById('hd').value = '';
            document.getElementById('hm').value = '';
            document.getElementById('hy').value = '';
            currentPage.history = 1; // Reset à la page 1
            filtHist();
        }
        
        // ========== PRODUITS LES PLUS VENDUS ==========
        function renderBestsellers() {
            const searchValue = document.getElementById('bestsellers-search')?.value.toLowerCase() || '';
            const isSearching = searchValue.length > 0;
            
            // Calculer les ventes totales pour chaque produit (Sorties uniquement)
            const salesData = {};
            
            movements.forEach(m => {
                if (m.type === 'Sortie' || m.type === 'exit' || m.type === 'out') {
                    const productName = m.productName || 'Produit';
                    if (!salesData[productName]) {
                        salesData[productName] = 0;
                    }
                    salesData[productName] += parseInt(m.quantity) || 0;
                }
            });
            
            // Créer un tableau avec les données de vente - SEULEMENT les produits vendus
            const bestsellers = products
                .map(p => {
                    const totalSold = salesData[p.name] || 0;
                    const totalStock = Object.values(p.pdvStock || {}).reduce((sum, qty) => sum + qty, 0);
                    return {
                        ...p,
                        totalSold: totalSold,
                        totalStock: totalStock
                    };
                })
                .filter(p => p.totalSold > 0); // FILTRER: seulement les produits avec ventes
            
            // Trier par total vendu (décroissant)
            const sortedBestsellers = bestsellers.sort((a, b) => b.totalSold - a.totalSold);
            
            // Filtrer si recherche
            let displayBestsellers;
            if (isSearching) {
                displayBestsellers = sortedBestsellers.filter(p => 
                    p.name.toLowerCase().includes(searchValue) || 
                    p.reference.toLowerCase().includes(searchValue)
                );
                document.getElementById('bestsellers-pagination').innerHTML = '';
            } else {
                displayBestsellers = paginateData(sortedBestsellers, currentPage.bestsellers || 1);
                renderPagination('bestsellers-pagination', 'bestsellers', sortedBestsellers.length);
            }
            
            // Afficher le tableau
            const tbody = document.getElementById('bestsellers-body');
            if (!tbody) return;
            
            if (displayBestsellers.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;">Aucun produit trouvé</td></tr>';
                return;
            }
            
            tbody.innerHTML = displayBestsellers.map((p, index) => {
                // Calculer le rang global
                const globalRank = isSearching ? sortedBestsellers.indexOf(p) + 1 : ((currentPage.bestsellers || 1) - 1) * ITEMS_PER_PAGE + index + 1;
                
                // Image
                let imgHtml = '<div style="width:50px;height:50px;display:flex;align-items:center;justify-content:center;font-size:30px;margin:auto;">📦</div>';
                if (p.imageUrl) {
                    const convertedUrl = convertGoogleDriveUrl(p.imageUrl);
                    if (convertedUrl) {
                        imgHtml = `<img src="${convertedUrl}" 
                                        style="width:50px;height:50px;object-fit:cover;border-radius:8px;cursor:pointer;display:block;margin:auto;" 
                                        onclick="zoomImg('${convertedUrl.replace(/'/g, "\\'")}')"
                                        onerror="this.onerror=null;this.outerHTML='<div style=\\'width:50px;height:50px;display:flex;align-items:center;justify-content:center;font-size:30px;margin:auto;\\'>📦</div>';"
                                        alt="${p.name}">`;
                    }
                }
                
                // Badge couleur selon le rang
                let rankBadge = '';
                if (globalRank === 1) {
                    rankBadge = `<span style="background:gold;color:#000;padding:6px 12px;border-radius:8px;font-weight:bold;">🥇 ${globalRank}</span>`;
                } else if (globalRank === 2) {
                    rankBadge = `<span style="background:silver;color:#000;padding:6px 12px;border-radius:8px;font-weight:bold;">🥈 ${globalRank}</span>`;
                } else if (globalRank === 3) {
                    rankBadge = `<span style="background:#cd7f32;color:#fff;padding:6px 12px;border-radius:8px;font-weight:bold;">🥉 ${globalRank}</span>`;
                } else {
                    rankBadge = `<span style="background:#e5e7eb;color:#1f2937;padding:6px 12px;border-radius:8px;font-weight:bold;">${globalRank}</span>`;
                }
                
                return `<tr>
                    <td style="text-align:center;">${rankBadge}</td>
                    <td style="text-align:center;">${imgHtml}</td>
                    <td><strong>${p.name}</strong></td>
                    <td>${p.reference}</td>
                    <td><span style="background:#ef4444;color:white;padding:6px 14px;border-radius:8px;font-weight:bold;">${p.totalSold}</span></td>
                    <td><span class="badge badge-success">${p.totalStock}</span></td>
                </tr>`;
            }).join('');
            
            // Setup recherche
            const searchInput = document.getElementById('bestsellers-search');
            if (searchInput && !searchInput.onInputSet) {
                searchInput.oninput = function() {
                    currentPage.bestsellers = 1;
                    renderBestsellers();
                };
                searchInput.onInputSet = true;
            }
        }
        
        // Initialiser currentPage.bestsellers
        if (!currentPage.bestsellers) {
            currentPage.bestsellers = 1;
        }

        function exportToExcel() {
            const data = products.map(p => {
                const row = {
                    'IMAGE': p.imageUrl || '',
                    'Real Name': p.realName || p.name,
                    'Conventional Name': p.conventionalName || '',
                    'Référence': p.reference,
                    'Barcode': p.barcode || '',
                    'Repetition': p.repetition || '',
                    'Category': p.category || '',
                    'Brand': p.brand || ''
                };

                pdvs.forEach(pdv => {
                    row[`QTY ${pdv.name}`] = p.pdvStock?.[pdv.id] || 0;
                });

                return row;
            });

            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Produits');
            XLSX.writeFile(wb, `stock_${new Date().toISOString().split('T')[0]}.xlsx`);
        }

        function handleImport(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    const rows = XLSX.utils.sheet_to_json(firstSheet);

                    console.log('📊 Import Excel - Nombre de lignes:', rows.length);
                    if (rows.length > 0) {
                        console.log('📋 Colonnes détectées:', Object.keys(rows[0]));
                    }

                    let imported = 0;
                    let updated = 0;

                    rows.forEach((r, index) => {
                        let imageUrl = (r['IMAGE'] || r['Image'] || '').toString().trim();
                        const realName = (r['Real Name'] || r['RealName'] || '').toString().trim();
                        const conventionalName = (r['Conventional Name'] || r['ConventionalName'] || '').toString().trim();
                        const reference = (r['Référence'] || r['Reference'] || '').toString().trim();
                        const barcode = (r['Barcode'] || '').toString().trim();
                        const repetition = (r['Repetition'] || r['Répétition'] || '').toString().trim();
                        const category = (r['Category'] || r['Catégorie'] || '').toString().trim();
                        const brand = (r['Brand'] || r['Marque'] || '').toString().trim();

                        const name = realName || conventionalName;
                        
                        if (!name || !reference) {
                            console.log(`⚠️ Ligne ${index + 2} ignorée: nom ou référence manquant`);
                            return;
                        }

                        // Convertir l'URL Google Drive
                        if (imageUrl) {
                            imageUrl = convertGoogleDriveUrl(imageUrl);
                            console.log(`🖼️ Ligne ${index + 2} - Image convertie pour ${name}`);
                        }

                        const pdvStock = {};
                        let totalQty = 0;

                        // Rechercher toutes les colonnes qui contiennent "QTY" ou "qty"
                        Object.keys(r).forEach(key => {
                            const keyLower = key.toLowerCase();
                            
                            // Détecter les colonnes QTY (plusieurs formats possibles)
                            if (keyLower.includes('qty') || keyLower.startsWith('q ')) {
                                const qty = parseInt(r[key]) || 0;
                                
                                if (qty > 0) {
                                    // Extraire le nom du PDV de la colonne
                                    let pdvName = key.replace(/^QTY\s*/i, '').replace(/^qty\s*/i, '').trim();
                                    
                                    if (pdvName) {
                                        // Chercher le PDV existant
                                        let pdv = pdvs.find(p => 
                                            p.name.toLowerCase() === pdvName.toLowerCase() ||
                                            p.name.toLowerCase().includes(pdvName.toLowerCase()) ||
                                            pdvName.toLowerCase().includes(p.name.toLowerCase())
                                        );

                                        // Si le PDV n'existe pas, le créer
                                        if (!pdv) {
                                            const newPdvId = pdvName.toLowerCase().replace(/\s+/g, '-').replace(/[^a-z0-9-]/g, '');
                                            pdv = { id: newPdvId, name: pdvName, location: '' };
                                            pdvs.push(pdv);
                                            console.log(`✅ Nouveau PDV créé: ${pdvName} (ID: ${newPdvId})`);
                                        }

                                        if (pdv) {
                                            pdvStock[pdv.id] = qty;
                                            totalQty += qty;
                                            console.log(`📦 ${name} - ${pdv.name}: ${qty} unités`);
                                        }
                                    }
                                }
                            }
                        });

                        const existing = products.find(p => p.reference === reference);
                        
                        if (existing) {
                            existing.name = name;
                            existing.realName = realName;
                            existing.conventionalName = conventionalName;
                            existing.imageUrl = imageUrl;
                            existing.barcode = barcode;
                            existing.repetition = repetition;
                            existing.category = category;
                            existing.brand = brand;
                            existing.pdvStock = pdvStock;
                            existing.quantity = totalQty;
                            updated++;
                            console.log(`🔄 Produit mis à jour: ${name} (${reference})`);
                        } else {
                            products.push({
                                id: Date.now().toString() + Math.random(),
                                name,
                                realName,
                                conventionalName,
                                reference,
                                barcode,
                                repetition,
                                category,
                                brand,
                                imageUrl,
                                quantity: totalQty,
                                pdvStock
                            });
                            imported++;
                            console.log(`➕ Nouveau produit: ${name} (${reference})`);
                        }
                    });

                    save();
                    renderProds();
                    renderPdv();
                    
                    let message = '✅ Import terminé !\n\n';
                    if (imported > 0) message += `➕ ${imported} nouveau(x) produit(s)\n`;
                    if (updated > 0) message += `🔄 ${updated} produit(s) mis à jour\n`;
                    message += `\n📍 ${pdvs.length} point(s) de vente détecté(s)`;
                    
                    console.log('📊 Résumé:', { imported, updated, totalPdvs: pdvs.length });
                    alert(message);
                } catch (err) {
                    console.error('❌ Erreur import:', err);
                    alert('❌ Erreur lors de l\'import : ' + err.message);
                }
            };
            reader.readAsArrayBuffer(file);
            event.target.value = '';
        }

        function logout() {
            if (confirm('Se déconnecter ?')) {
                localStorage.removeItem('currentUser');
                showLoginPage();
                document.getElementById('login-username').value = '';
                document.getElementById('login-password').value = '';
            }
        }
    

function doLogin() {
    var user = document.getElementById('login-username').value.trim();
    var pass = document.getElementById('login-password').value;
    var errDiv = document.getElementById('login-error');
    
    if (!supabaseClient) {
        errDiv.style.display = 'block';
        errDiv.textContent = 'Erreur: Supabase non initialisé';
        return;
    }
    
    supabaseClient
        .from('users')
        .select('*')
        .eq('password', pass)
        .or('username.eq.' + user + ',email.eq.' + user)
        .single()
        .then(function(result) {
            if (result.error || !result.data) {
                errDiv.style.display = 'block';
                errDiv.textContent = 'Identifiants incorrects';
                console.error('Erreur login:', result.error);
                return;
            }
            currentUser = result.data;
            currentSupabaseUser = result.data; // IMPORTANT: pour que save() fonctionne
            useSupabase = true;
            
            // Charger les données depuis Supabase
            loadFromSupabase().then(function() {
                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
                document.getElementById('user-name').textContent = currentUser.full_name || 'Utilisateur';
                document.getElementById('user-email').textContent = currentUser.email || currentUser.username;
                
                renderProds();
                renderPdv();
                renderMovForm();
                renderHist();
                renderDash();
                
                showNotification('Bienvenue ' + currentUser.full_name, 'success');
                console.log('✅ Connexion réussie:', currentUser.username);
            });
        })
        .catch(function(err) {
            errDiv.style.display = 'block';
            errDiv.textContent = 'Erreur: ' + err.message;
            console.error('Erreur catch:', err);
        });
}

</script>
</body>
</html>
